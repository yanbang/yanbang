<template>
   <div style="position: absolute;height:90%;width: 100%;overflow: auto" >
     <el-table
       :data="finishCity"
       style="width: 100%" size = "small"
     >

       <el-table-column
         prop="eparchyName"
         label="地区"
       >
         <template slot-scope="scope">
           <span>
             {{ scope.row.areaCode ==='00' ? scope.row.eparchyName : scope.row.areaName}}
          </span>
         </template>
       </el-table-column>
       <el-table-column
         prop=""
         label="完成率"
       >
         <el-table-column
           prop="pct0"
           label="0%"
         >
           <template slot-scope="scope">
             <span class="titleSpan1" @click="clickRow(scope.row,'1')">{{scope.row.pct0}}</span>
           </template>
         </el-table-column>
         <el-table-column
           prop="pct50"
           label="0%~50%"
         >
           <template slot-scope="scope">
             <span class="titleSpan1" @click="clickRow(scope.row,'2')">{{scope.row.pct50}}</span>
           </template>
         </el-table-column>
         <el-table-column
           prop="pct100"
           label="50%~100%"
           width="">
           <template slot-scope="scope">
             <span class="titleSpan1" @click="clickRow(scope.row,'3')">{{scope.row.pct100}}</span>
           </template>
         </el-table-column>

         <el-table-column
           prop="pctOver"
           label=">100%"
         >
           <template slot-scope="scope">
             <span class="titleSpan1" @click="clickRow(scope.row,'4')">{{scope.row.pctOver}}</span>
           </template>
         </el-table-column>
       </el-table-column>

     </el-table>
     <div>
       <el-dialog width="70%" :title="title" :visible.sync="dialogTableVisible" :modal-append-to-body='false'>
          <dialogComponent :row-data="rowData" :pop-list="popList" :data-type="dataType"></dialogComponent>
       </el-dialog>
     </div>

   </div>

</template>

<script>
  import dialogComponent from '@/components/FifthGeneration/dialogComponent'
  import { getPopList } from '@/views/Evaluate/service/service'
  export default {
    props:{
      rightList:Array
    },
    name: 'AroundFinishCity',
    components: {
      dialogComponent
    },
    data(){
      return{
        dialogTableVisible:false,
        popList:[
        ],
        title:'',
        finishCity:[
        ],
        rowData:{},
        dataType:'',
        isGrad:false
      }
    },
    watch:{
      rightList(){
        this.finishCity = [];
        this.finishCity = this.rightList
        this.finishCity.forEach(obj => {
          obj.pct0 = parseInt(obj.pct0)
          obj.pct50 = parseInt(obj.pct50)
          obj.pct100 = parseInt(obj.pct100)
          obj.pctOver = parseInt(obj.pctOver)
          if (obj.areaCode !== '00'){
            this.isGrad = true
          }else {
            this.isGrad = false
          }
        })
      }
    },
    mounted(){
      this.getPopList()
      if(this.rightList){
        this.finishCity = [];
        this.finishCity = this.rightList
      }
    },
    methods:{
      handle(row,event,column){
        this.dialogTableVisible = true
      },
      goto(row,event,column){
        //alert(123)
      },
      clickRow(rowData,type){
        this.rowData = rowData
        this.dataType = type
        let str = ''
        if (type === '1'){
          str = '完成率=0%'
        }else if (type === '2'){
          str = '0%<完成率≤50%'
        }else if (type === '3'){
          str = '50%<完成率≤100%'
        }else {
          str = '完成率>100%'
        }
        // if (rowData.areaCode==='00'){
          this.title = rowData.eparchyName + '周完成率' + str + '的营服'
        // }else {
        //   this.title = rowData.areaName + '周完成率' + str + '的营服'
        //
        // }
        this.dialogTableVisible = true
        this.getPopList()
      },
      getPopList(){
        getPopList({
          "timest":this.$parent.$parent.getChildValue,
          "eparchyCode":this.rowData.eparchyCode,
          "areaCode":this.rowData.areaCode === '00' ? '' : this.rowData.areaCode,
          "gridId":'',
          "flag":this.$route.query.eparchyName ? this.$route.query.eparchyName.flag : this.$parent.$parent.flag,
          "pctFlag":this.dataType,
        }).then(res => {
          this.popList = res.result.tblList
          // alert(this.rowData.flag)
          // alert(this.rowData.pctFlag)
          //alert(this.$route.query.eparchyName.flag)
          res.result.tblList.forEach(datas=>{

          })
        }).catch(() => {
          //console.log(123)
        })
      }
    }
  }
</script>

<style scoped>
/deep/ .el-table--border th {
  border-bottom: none;
}
/deep/ .el-table--group,
.el-table--border {
  border: none;
  border-right: none !important;
}
/deep/ .el-table--border th,
.el-table--border td {
  border-right: none !important;
}
/deep/ .el-table{
  background: none !important;
  font-size: 18px !important;
  font-family: Microsoft YaHei !important;
  font-weight: 400 !important;
}
/deep/.el-table th{
  background: none !important;
  background: url("../../assets/images/bigScreen/fullService/597bcdc505fa3.png") 50% 18px  !important;
  text-align: center !important;
  color: #02F6FF !important;
  font-size: 12px !important;
  background-repeat: no-repeat;
  background-size: cover;
  background-position: bottom center ;
}
/deep/ .el-table tr{
  background: none !important;
}
/deep/.el-table td{
  background: none !important;
  border: none !important;
  text-align: center !important;
  color: #FFFFFF;
  border-right: 0.5px solid #0A3D75 !important;
}
/deep/ .el-table th.is-leaf, .el-table td{
  border: none !important;
  color: #FFFFFF ;
}
/deep/.el-table::before{
  height: 0 !important;
}
/deep/.el-table th > .cell{
  display: contents !important;
}
/deep/.el-dialog{
  width: 66%;
  background:transparent;
  background-image:url("../../assets/images/bigScreen/kuang.png");
  background-size: 100% 100%;
  /*background-repeat:no-repeat ;*/
  /*background-size: cover;*/
  min-height:550px
}
/deep/.el-icon-close:before{

  content: none !important;
}
/deep/.el-dialog__headerbtn .el-dialog__close{
  width: 35px;
  height: 35px;
  background-image: url("../../assets/images/bigScreen/close.png");
  background-repeat:no-repeat ;
  margin: 14px 30px;

}
/deep/.el-dialog__title{
  color: #02F6FF;
  font-size: 24px;
  width: 555px;
  font-size: 24px;
  font-family: PangMenZhengDao-3;
  font-weight: 400;
  background-image: url("../../assets/images/bigScreen/fullService/biaoti.png");
  background-position: right;
  background-repeat: no-repeat;
  margin-left: 30px;
  display: block;
}
.titleSpan1{
  color: #FDFEFF;
  font-size: 14px;
  cursor: pointer;
  font-family: 'DigifaceWide';
  src: url('../../assets/fonts/digifaw.ttf');
  display: block;
}
/deep/.el-dialog__title{
  position: relative;
  top: 18px;
}
</style>