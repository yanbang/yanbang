<template>
  <el-dialog title="" :visible.sync="dialogVisible" width="60%">
    <template slot="title">
      <div style="margin-top: 10px;margin-left: 20px;width: 100%">
        <span class="chartTitle">渠道门店5G发展按产品详情</span>
        <img src="~@/assets/images/bigScreen/fullService/Rectangle@2x.png" style="height: 14px;width: 86px;margin-left: 10px;margin-top: -3px">
        <div style="float: right;margin-right: 80px">
          <div class="daydiv" :class="{ active: currentIndex == 'd' }" @click="clickdayType('d')">
            当日
          </div>
          <div class="daydiv" :class="{ active: currentIndex == 'm' }" @click="clickdayType('m')">
            当月
          </div>
          <div class="daydiv" :class="{ active: currentIndex == 'q' }" @click="clickdayType('q')">
            季度
          </div>
        </div>
      </div>
    </template>
    <div class="dialogTableBg1">
      <el-table ref="table" :data="dialogTable1" style="padding-left: 30px;padding-right:30px;height:630px;overflow: auto;">
        <el-table-column prop="name" label="产品">
          <template slot-scope="scope">
            <img v-if="scope.row.name&&scope.row.show" style="margin-right:15px;height: 13px;width: 13px" src="~@/assets/images/bigScreen/fullService/chanel_jian.png" @click="showMore(scope.$index,scope.row)" />
            <img v-if="scope.row.name&&(!scope.row.show)" style="margin-right:15px;height: 13px;width: 13px" src="~@/assets/images/bigScreen/fullService/chanel_add.png" @click="showMore(scope.$index,scope.row)" />
            <span>{{scope.row.name}}</span>
          </template>
        </el-table-column>
        <el-table-column prop="total" label="发展量">
          <template slot-scope="scope">
            <span>{{scope.row.cnt}}</span>
          </template>
        </el-table-column>
        <el-table-column type="expand" width="1">
          <template slot-scope="props">
            <el-table class="tableNullBg subtableini" :show-header="false" :data="props.row.Data" style="width: 100%">
              <el-table-column prop="productName" label=""></el-table-column>

              <el-table-column prop="cnt" label=""></el-table-column>
            </el-table>
          </template>
        </el-table-column>
      </el-table>
    </div>
  </el-dialog>
</template>

<script>
import { chl_5gdevelop_more } from '@/api/chanel.js'
import { getSmsCaptcha } from '@/api/login'
import store from 'store'
export default {
  props: ['params', 'biztype', 'tabId'],
  name: "fiveGDialog",
  data() {
    return {
      dialogVisible: false,
      tableData: [],
      tableData2: [],
      tableData3: [],
      selectName: '当日发展',
      currentIndex: 'd',
      timest: '',
      dialogTable1: [],
      tableListName: [
        {
          productName: "5G套餐新发展",
          dayNew: "3923",
          monNew: "3923",
          yearNew: "3923",
          isShow: false,
          isParent: true
        },
        {
          productName: "升级包",
          dayNew: "3923",
          monNew: "3923",
          yearNew: "3923",
          isShow: false,
          isParent: true
        },
        {
          productName: "4G套餐转5G套",
          dayNew: "3923",
          monNew: "3923",
          yearNew: "3923",
          isShow: false,
          isParent: true
        }
      ],
      userInfo: {},

    }
  },

  watch: {
    dialogVisible(val) {
      if (!val) {
        this.$emit('closeFiveGDialog', '')
      }
    }
  },
  methods: {
    handle() {

    },
    toogleExpand() {

    },
    clickdayType(index) {
      this.currentIndex = index
      this.getfiveGList()
    },
    showMore(index, row, val) {
      this.dialogTable1[index].show = !this.dialogTable1[index].show
      let $table = this.$refs.table;
      $table.toggleRowExpansion(row)
    },
    handleSelectionChange() { },
    getfiveGList(type) {
      this.userInfo = store.get('userInfo');
      let param = this.params;
      param.BIZ_TYPE = this.biztype
      param.chnlKindId = this.tabId
      param.LIMIT = 10;
      param.timeVeidoo = this.currentIndex;
      this.dialogTable1 = []
      chl_5gdevelop_more(param).then(res => {
        console.log(res, 123, this.params)
        if (res.result) {
          var datal = res.result.data;
          datal.forEach(item => {
            item.name = ''
            item.show = false;
            if (item.productTypeCode == 1) {
              item.name = '5G套餐用户'
            } else if (item.productTypeCode == 2) {
              item.name = '升级包用户'
            } else if (item.productTypeCode == 3) {
              item.name = '4G升5G用户'
            };
            item.cnt = ''
            if (this.currentIndex == 'd') {
              item.cnt = item.dayNew
            } else if (this.currentIndex == 'm') {
              item.cnt = item.monNew
            } else if (this.currentIndex == 'q') {
              item.cnt = item.qtNew
            }
            item.Data.length && item.Data.forEach(sitem => {
              sitem.cnt = ''
              if (this.currentIndex == 'd') {
                sitem.cnt = sitem.dayNew
              } else if (this.currentIndex == 'm') {
                sitem.cnt = sitem.monNew
              } else if (this.currentIndex == 'q') {
                sitem.cnt = sitem.qtNew
              }
            })
          })
          this.dialogTable1 = datal
          this.dialogTable1.forEach(obj => {
            obj.show = false
          })

        }


      })
    }
  },
  mounted() {
    this.dialogVisible = true
    this.getfiveGList()
  }
}
</script>

<style scoped lang = "scss">
/deep/ .subtableini table tbody tr td:first-child {
  padding-left: 35px !important;
}
/deep/ .el-dialog {
  -webkit-transform: none;
  transform: none;
  left: 0;
  position: relative;
  margin: 0 auto;
  background-image: url('~@/assets/images/bigScreen/fullService/fixDataBg.png');
  background-size: 100% 100%;
  background-color: rgba(220, 38, 38, 0);
}
.dialogCon {
  padding: 0 50px;
  .dialogTitle {
    display: inline-block;
    padding-right: 110px;
    font-size: 24px;
    font-family: MFBanHei;
    font-weight: 400;
    color: #02f6ff;
    background-image: image-set(
      url('~@/assets/images/bigScreen/fullService/Rectangle 561.png') 1x,
      url('~@/assets/images/bigScreen/fullService/Rectangle@2x.png') 2x
    );
    background-repeat: no-repeat;
    background-position: center right;

    .title-right {
      color: #218cc8;
      div {
        width: 38px;
        height: 30px;
        line-height: 30px;
        text-align: center;
        display: inline-block;
        cursor: pointer;
        background-image: image-set(
          url('~@/assets/images/bigScreen/fullService/left-sub.png') 1x,
          url('~@/assets/images/bigScreen/fullService/left-sub@2x.png') 2x
        );
        background-repeat: no-repeat;
        background-size: 100% 100%;
      }
      .active {
        color: #02f6ff;
        background-image: image-set(
          url('~@/assets/images/bigScreen/fullService/left-subActive.png') 1x,
          url('~@/assets/images/bigScreen/fullService/left-subActive@2x.png') 2x
        );
      }
    }
  }
  .dialogChart {
    width: 100%;
    height: 400px;
    margin-top: 50px;
  }
}
/deep/ .el-dialog {
  -webkit-transform: none;
  transform: none;
  left: 0;
  position: relative;
  margin: 0 auto;
  height: 550px;
  background-image: url('~@/assets/images/bigScreen/kuang.png');
  background-size: 100% 100%;
  background-color: rgba(220, 38, 38, 0);
}
/deep/ .el-dialog__body {
  padding: 0px 20px;
}
/deep/ .el-dialog__headerbtn .el-dialog__close {
  color: #fff;
  font-size: 24px;
  font-weight: 500;
  margin: 2px 20px 0 0;
  border: 2px solid #193987;
  border-radius: 5px;
  background: #1e1e88;
}
/deep/ .el-table {
  background: none !important;
  font-size: 14px !important;
}
/deep/.dialogTableBg .el-table th {
  background: none !important;
  background: url('~@/assets/images/bigScreen/fullService/597bcdc505fa3.png') no-repeat !important;
  background-position: center 11px !important;
  background-size: contain !important;
  text-align: center !important;
  color: #02f6ff !important;
  font-size: 10px !important;
}
/deep/.dialogTableBg1 .el-table th {
  background: rgba(4, 154, 171, 0.2) !important;
  background-position: center 11px !important;
  background-size: contain !important;
  text-align: left !important;
  color: #fff !important;
  font-size: 12px !important;
  padding-left: 30px;
}
/deep/.dialogTableBg1 .el-table tr {
  background: rgba(4, 154, 171, 0.4) !important;
  color: #fff !important;
  padding-left: 30px;
}
/deep/.dialogTableBg1 .el-table td {
  padding: 12px 0;
  padding-left: 15px;
  border: rgba(0, 160, 233, 0.42) solid 1px !important;
  border-top: none !important;
  text-align: left !important;
  border-left: none !important;
}
/deep/.dialogTableBg1 .el-table td:nth-child(2) {
  border-right: none !important;
}
/deep/.dialogTableBg1 .el-table td:nth-child(3) {
  border-right: none !important;
}
/deep/ .dialogTableBg1 .tableNullBg tr {
  background: none !important;
}
/deep/.dialogTableBg1 .el-table .el-table__expanded-cell {
  padding: 0 !important;
}
/deep/ .dialogTableBg1 .tableNullBg td {
  padding: 12px 0;
  padding-left: 15px;
}
/deep/ .dialogTableBg1 .tableNullBg td:first-child {
  padding-left: 45px;
}
/deep/.dialogTable .el-table th {
  background: none !important;
  background-position: center 11px !important;
  background-size: contain !important;
  text-align: center !important;
  color: #02f6ff !important;
  font-size: 14px !important;
}
/deep/ .el-table tr {
  background: none !important;
}
/deep/.dialogTable .el-table tbody tr:nth-child(-n + 3) {
  width: 100%;
  background-image: url('~@/assets/images/bigScreen/fullService/Rectangle 663.png') !important;
  background-repeat: no-repeat !important;
  background-size: 100% 100% !important;
}
/deep/.dialogTable .el-table td {
  padding: 6px 10px;
  font-size: 14px !important;
  font-family: Microsoft YaHei !important;
}
/deep/.dialogTable .el-table tbody td:nth-child(-n + 2) {
  text-align: left !important;
}
/deep/.el-table td {
  background: none !important;
  border: none !important;
  text-align: center !important;
  color: #ffffff;
  font-family: DigifaceWide !important;
  padding: 6px 0;
}
/deep/.dialogTableBg td {
  background: url('~@/assets/images/bigScreen/fullService/Shape 1387.png') no-repeat left !important;
}
/deep/.el-table td:first-child {
  background: none !important;
}
/deep/.dialogTableBg .el-table td:first-child {
  font-family: Microsoft YaHei !important;
}
/deep/ .el-table th.is-leaf,
.el-table td {
  border: none !important;
  color: #ffffff;
}
/deep/.el-table::before {
  height: 0 !important;
}
/deep/.el-table th > .cell {
  display: contents !important;
}
/deep/.el-table .cell {
  padding: 0;
}
/deep/.el-table .ascending .sort-caret.ascending {
  border-bottom-color: #02f6ff;
}

/deep/.el-table .descending .sort-caret.descending {
  border-top-color: #02f6ff;
}
.titleSpan1 {
  color: #fdfeff;
  font-size: 14px;
  font-family: 'DigifaceWide';
  src: url('~@/assets/fonts/digifaw.ttf');
  display: block;
}
.chartTitle {
  margin-top: 10px;
  margin-left: 10px;
  font-family: 'MFBanHei';
  color: #02f6ff;
  font-size: 24px;
}
.title-right {
  color: #218cc8;
}
.daydiv {
  width: 38px;
  height: 30px;
  line-height: 30px;
  text-align: center;
  display: inline-block;
  cursor: pointer;
  font-size: 12px;
  color: #218cc8;
  background-image: image-set(
    url('~@/assets/images/bigScreen/fullService/left-sub.png') 1x,
    url('~@/assets/images/bigScreen/fullService/left-sub@2x.png') 2x
  );
  background-repeat: no-repeat;
  background-size: 100% 100%;
}
.active {
  color: #02f6ff;
  font-size: 12px;
  background-image: image-set(
    url('~@/assets/images/bigScreen/fullService/left-subActive.png') 1x,
    url('~@/assets/images/bigScreen/fullService/left-subActive@2x.png') 2x
  );
}
/deep/ .el-table {
  background: none !important;
  font-size: 14px !important;
}
/deep/.dialogTableBg .el-table th {
  background: none !important;
  background: url('~@/assets/images/bigScreen/fullService/597bcdc505fa3.png') no-repeat !important;
  background-position: center 11px !important;
  background-size: contain !important;
  text-align: center !important;
  color: #02f6ff !important;
  font-size: 10px !important;
}
/deep/.dialogTableBg1 .el-table th {
  background: rgba(4, 154, 171, 0.2) !important;
  background-position: center 11px !important;
  background-size: contain !important;
  text-align: left !important;
  color: #fff !important;
  font-size: 12px !important;
  padding-left: 30px;
}
/deep/.dialogTableBg1 .el-table tr {
  background: rgba(4, 154, 171, 0.4) !important;
  color: #fff !important;
  padding-left: 30px;
}
/deep/.dialogTableBg1 .el-table td {
  padding: 12px 0;
  padding-left: 15px;
  border: rgba(0, 160, 233, 0.42) solid 1px !important;
  border-top: none !important;
  text-align: left !important;
  border-left: none !important;
}
/deep/.dialogTableBg1 .el-table td:nth-child(2) {
  border-right: none !important;
}
/deep/.dialogTableBg1 .el-table td:nth-child(3) {
  border-right: none !important;
}
/deep/.dialogTableBg1 .el-table tr:last-child td {
  border-bottom: none !important;
}
/deep/ .dialogTableBg1 .tableNullBg tr {
  background: none !important;
}
/deep/.dialogTableBg1 .el-table .el-table__expanded-cell {
  padding: 0 !important;
}
/deep/ .dialogTableBg1 .tableNullBg td {
  padding: 12px 0;
  padding-left: 15px;
}
/deep/ .dialogTableBg1 .tableNullBg td:first-child {
  padding-left: 45px;
}
/deep/.dialogTable .el-table th {
  background: none !important;
  background-position: center 11px !important;
  background-size: contain !important;
  text-align: center !important;
  color: #02f6ff !important;
  font-size: 10px !important;
}
/deep/ .el-table tr {
  background: none !important;
}

/deep/.dialogTable .el-table tbody tr:nth-child(-n + 3) {
  width: 100%;
  height: 43px;
  background-image: url('~@/assets/images/bigScreen/fullService/Rectangle 663.png') !important;
  background-repeat: no-repeat !important;
  background-size: 100% !important;
}

/deep/.el-table td {
  background: none !important;
  border: none !important;
  text-align: center !important;
  color: #ffffff;
  font-family: DigifaceWide !important;
  padding: 6px 0;
}
/deep/.dialogTableBg td {
  background: url('~@/assets/images/bigScreen/fullService/Shape 1387.png') no-repeat left !important;
}
/deep/.el-table td:first-child {
  background: none !important;
}
/deep/.dialogTableBg .el-table td:first-child {
  font-family: Microsoft YaHei !important;
}
/deep/ .el-table th.is-leaf,
.el-table td {
  border: none !important;
  color: #ffffff;
}
/deep/.el-table::before {
  height: 0 !important;
}
/deep/.el-table th > .cell {
  display: contents !important;
}
/deep/.el-table .cell {
  padding: 0;
}
/deep/.el-table .ascending .sort-caret.ascending {
  border-bottom-color: #02f6ff;
}

/deep/.el-table .descending .sort-caret.descending {
  border-top-color: #02f6ff;
}
</style>