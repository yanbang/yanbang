<template>
  <div>
    <div class="Center_L" id="stackChart" ref="myCharts"></div>
  </div>

</template>

<script>
export default {
  name: "singlecharts",
  props:{
    trendList:Array
  },
  data() {
    return {

    }
  },
  components: {

  },
  watch:{
    trendList(){
      let areaNames = []
      let fristdata = []
      let lastdata = []
      let linedata = []
      this.trendList.forEach(obj => {
        areaNames.push(obj.eparchyName)
        fristdata.push(parseFloat(obj.newWeekSwYcz))
        lastdata.push(parseFloat(obj.newWeekSwWcz))
        linedata.push(parseFloat(obj.newWeekSwRate))
      })
      areaNames.splice(0,1)
      fristdata.splice(0,1)
      lastdata.splice(0,1)
      linedata.splice(0,1)
      this.stackCharts(areaNames,fristdata,lastdata,linedata)
    }
  },
  mounted() {
    this.stackCharts()

  },
  methods: {
    stackCharts(areaNames,fristdata,lastdata,linedata){

      Highcharts.chart('stackChart', {
        chart: {
          type: 'column',
          backgroundColor: 'transparent',
          options3d: {
            enabled: true,
            alpha: 10,
            beta: 0,
            viewDistance: 65,
            depth: 60
          },
          marginTop: 0,
          marginRight: 0
        },
        title: {
          text: '',
        },
        exporting: {
          enabled: false
        },
        credits: {
          enabled: false
        },
        xAxis: {
          categories: areaNames,
          tickWidth: '0',    	//设置刻度标签宽度
          lineColor: '#fff',//设置坐标颜色
          color: '#A9C0FF',
          lineWidth: 0,   //设置坐标宽度
          gridLineColor: 'transparent',
          labels: {
            style: {
              color: '#A9C0FF',
              fontSize: '18px'
            }
          },
        },
        yAxis: [
          { // Primary yAxis
            allowDecimals: false,
            gridLineColor: 'transparent',
            lineWidth: 0,
            labels: {
              enabled: false,
              style: {
                color: 'transparent'
              }
            },
            title: {
              text: '量',
              style: {
                color: 'transparent'
              }
            }
          },
          { // Secondary yAxis
            allowDecimals: false,
            gridLineColor: 'transparent',
            lineWidth: 0,
            title: {
              text: '占比',
              style: {
                color: 'transparent'
              }
            },
            labels: {
              enabled: false,
              style: {
                color: 'transparent'
              }
            },
            opposite: true
          }],
        tooltip: { 
          shared: true,
          borderColor: 'transparent',
          backgroundColor: 'rgba(50,50,50,0.7)',
          style: {
              color: '#fff',
              fontSize: '14px',
          }
        },
        plotOptions: {
          column: {
            stacking: 'normal',
            depth: 10
          },
          line: {
            dataLabels: {
              // 开启数据标签
              enabled: true,
              formatter: function () {
                return this.point.y + '%';
              },
              style: {
                fontSize: '14px',
                color: '#fff',
                border: 0
              }
            },
            // 关闭鼠标跟踪，对应的提示框、点击事件会失效
            // enableMouseTracking: false
          }

        },
        legend: {
          itemStyle: {
            fontSize: '14px',
            color: '#A9C0FF',
          },
          series: ['三无用户首月出账','三无用户首月未出账','三无用户占比']
        },
        series: [
          {
            name: '三无用户首月出账',
            data: fristdata,
            stack: 'female',
            color: {
              linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 }, //横向渐变效果 如果将x2和y2值交换将会变成纵向渐变效果
              stops: [
                [0, Highcharts.Color('#86ba4b').setOpacity(1).get('rgba')],
                [1, '#5aaa25']
              ]
            }
          },


          {
            name: '三无用户首月未出账',
            data: lastdata,
            stack: 'female',
            color: {
              linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 }, //横向渐变效果 如果将x2和y2值交换将会变成纵向渐变效果
              stops: [
                [0, Highcharts.Color('#01d4e9').setOpacity(1).get('rgba')],
                [1, '#05b1e1']
              ]
            }
          },
          {
            name: '三无用户占比',
            data: linedata,
            type: 'line',
            color: '#FF8279',
            zIndex: '1000',
            yAxis: 1,
            dataLabels: {
              color: '#fff'
            },
            marker: {
              radius: 6,  //曲线点半径，默认是4
              symbol: 'circle' //曲线点类型："circle", "square", "diamond", "triangle","triangle-down"，默认是"circle"
            },
          }
        ]
      });
    }

  },

}
</script>

<style scoped>
#stackChart {
  width: 100%;
  height: 39vh;
}
</style>