<!-- 小区资源详情 -->
<template>
  <div>
    <div>
       <el-table :data="bstableData" style="width: 100%" height="580px" class="nfont bstable" @sort-change="changeSort" >
       
        <el-table-column v-if="tagactive == 1" prop="myInitName" label="地区"  show-overflow-tooltip width="220"   align="center"></el-table-column>
        <el-table-column v-if="tagactive != 1" prop="eparchyName" label="地市"  show-overflow-tooltip width="130"    align="center"   ></el-table-column>
        <el-table-column v-if="tagactive != 1" prop="areaName" label="区县"  show-overflow-tooltip   width="130"   align="center" ></el-table-column>
        <el-table-column v-if="tagactive != 1" prop="gridName" label="营服"  show-overflow-tooltip    align="center"  width="220" ></el-table-column>
        <el-table-column v-if="tagactive != 1" prop="villageNameTot" label="小区名称"  show-overflow-tooltip    align="center"  width="220" ></el-table-column>
        
        <el-table-column prop="porRate" label="本月端口实占率"    align="center"  width="auto">
          <template slot-scope="scope">
                <span> {{renderPval(scope.row.porRate)}} </span>
          </template>
        </el-table-column>
        <el-table-column prop="porRateLastmon" label="上月端口实占率"   align="center"  width="auto">
           <template slot-scope="scope">
              <span> {{renderPval(scope.row.porRateLastmon)}} </span>
          </template>
        </el-table-column>
        
        <el-table-column :prop="tagactive == 1 ? 'porPerHuanbi' : 'porRateHb'" label="端口实占率环比"  sortable = "custom"   align="center"  width="auto">
          <template slot-scope="scope">
              <span> {{renderPval(scope.row.porPerHuanbi)}} </span>
          </template>
        </el-table-column>
        <el-table-column prop="famRate" label="本月家庭渗透率"    align="center"  width="auto">
           <template slot-scope="scope">
              <span> {{renderPval(scope.row.famRate)}} </span>
          </template>
        </el-table-column>
        <el-table-column prop="famRateLastmon" label="上月家庭渗透率"    align="center"  width="auto">
           <template slot-scope="scope">
              <span> {{renderPval(scope.row.famRateLastmon)}} </span>
          </template>
        </el-table-column>

         <el-table-column :prop="tagactive == 1 ? 'famPerHuanbi' : 'famRateHb'" label="家庭渗透率环"  sortable = "custom"   align="center"  width="auto">
           <template slot-scope="scope">
               <span> {{renderPval(scope.row.famPerHuanbi)}} </span>
            </template>
        </el-table-column>          
       </el-table>
    </div>
  </div>
</template>

<script>
var lodash = require('@/utils/lodash')
export default {
  props: ['tagactive', 'tabledata'],
  data () {
    return {
      bstableData: []
    }
  },
  components: {},
  mounted () {},
  watch: {
    tabledata (data) {
      this.bstableData =  _.cloneDeep(data);
    }
  },
  computed: {},
  methods: {
    renderPval (val) {
      if (!val && val != 0) {
        return '-'
      } else {
        return val +'%'
      }
    },
    changeSort (row) {
       var  ordertype = row.order;
      if (this.tagactive == 1 && this.tabledata.length > 0 ) {
         var fistData = this.tabledata[0];
         var allData = _.cloneDeep(this.tabledata)
         allData.shift();
        
         if (ordertype){
            ordertype = ordertype == 'ascending' ? 'asc' : 'desc'
            allData = _.orderBy(allData, row.prop,  ordertype)
            allData.unshift(fistData)
            this.bstableData = allData;
         } else {
           this.bstableData =  _.cloneDeep(this.tabledata);
         }
      } else {
        if (ordertype){
            ordertype = ordertype == 'ascending' ? 'asc' : 'desc'
            this.bstableData = _.orderBy(this.bstableData, row.prop,  ordertype)
         } else {
           this.bstableData =  _.cloneDeep(this.tabledata);
         }
      }
      
    }
  }
}
</script>

<style lang='css' scoped>
</style>