<!--应急通信 -->
<template>
  <div class = "contentbox">
     <Header title = "山东联通网络智慧眼-无线" subtitle = "无线赋能"></Header>
    <div class = "contentbody">
      <div class = "leftbox flex colflex">
        <div class = "box-item flex colflex ">
           <div class = "item-title titlefont">
             <span>用户使用情况</span>
           </div>
           <div  class = "flex1 flex" style="margin-bottom: 10px">
              <div class="flex1">
                <div class="chartbox anpiebox" id = "anipie1"></div>
                <div class = "piefont">5G登网率</div>
              </div>
              <div class="flex1">
                 <div class="chartbox anpiebox" id = "anipie2"></div>
                 <div class = "piefont">5G业务流量驻留比</div>
              </div>
              <div class="flex1">
                 <div class="chartbox anpiebox" id = "anipie3"></div>
                 <div class = "piefont">VOLTE注册率</div>
              </div>
           </div>
        </div>

        <div class = "box-item flex colflex ">
           <div class = "item-title titlefont">
             <span>用户数量对比</span>
           </div>
             <div  class = "flex1" style="position: relative;">
                <div class="chartbox" id = "compareBar1" style="height: 150px"></div>  
            </div>
        </div>

         <div class = "box-item flex colflex flex1">
           <div class = "item-title titlefont">
             <span>业务分布</span>
             <span class = "tunit">(T)</span>
           </div>
           <div class = "rowttabs">
             <span class="rowttabs-item" :class="{'active': rowttabStatus == '1'}" @click="rowttabsClick('1')">流量分布</span>
             <span class="rowttabs-item" :class="{'active': rowttabStatus == '2'}" @click="rowttabsClick('2')">语音分布</span>
           </div>
            <div  class = "flex1">
               <div class="chartbox" id = "chartBarline1"></div>
            </div>
        </div>


        <div class = "box-item flex colflex flex1">
           <div class = "item-title titlefont">
             <span>用户偏好状况</span>
           </div>
            <div  class = "flex1">
               <div class="chartbox" id="chart_appph" style="height: 250px"></div>
            </div>
        </div>
      </div>
      <div class = "centerbox flex colflex">
          <div class = "ctop-box flex" style="height: auto">
           <dv-border-box-10 :color="['#0f3da2', '#547fde']" class = "flex">
              <div class="flex1 rowtitem rowtitem1">
                 <div>
                    <div class="sub_rowtitem sub_rowtitem1">
                      <div class="inconbox">
                        <img src="@/assets/images/jzic.png" alt="" srcset="">
                      </div>
                      <div class="flex1">
                          <div class="numfont">41232</div>
                          <div class="titlefont">3G逻辑基站数</div>
                      </div>
                    </div>
                    <div class="sub_rowtitem">
                      <div class="inconbox">
                        <img src="@/assets/images/xqic.png" alt="" srcset="">
                      </div>
                      <div class="flex1">
                          <div class="numfont">41232</div>
                          <div class="titlefont">3G逻辑小区数</div>
                      </div>
                    </div>
                  </div>
              </div>
                <div class="flex1 rowtitem">
                  <div>
                    <div class="sub_rowtitem">
                      <!-- <div class="inconbox">
                        <img src="@/assets/images/jzic.png" alt="" srcset="">
                      </div> -->
                      <div class="flex1">
                          <div class="numfont">41232</div>
                          <div class="titlefont">4G逻辑基站数</div>
                      </div>
                    </div>
                    <div class="sub_rowtitem">
                      <!-- <div class="inconbox">
                        <img src="@/assets/images/xqic.png" alt="" srcset="">
                      </div> -->
                      <div class="flex1">
                          <div class="numfont">41232</div>
                          <div class="titlefont">4G逻辑小区数</div>
                      </div>
                    </div>
                  </div>
              </div>
               <div class="flex1 rowtitem">
                  <div>
                    <div class="sub_rowtitem">
                      <!-- <div class="inconbox">
                        <img src="@/assets/images/jzic.png" alt="" srcset="">
                      </div> -->
                      <div class="flex1">
                          <div class="numfont">41232</div>
                          <div class="titlefont">5G逻辑基站数</div>
                      </div>
                    </div>
                    <div class="sub_rowtitem">
                      <!-- <div class="inconbox">
                        <img src="@/assets/images/xqic.png" alt="" srcset="">
                      </div> -->
                      <div class="flex1">
                          <div class="numfont">41232</div>
                          <div class="titlefont">5G逻辑小区数</div>
                      </div>
                    </div>
                  </div>
              </div>
              <div class="flex1" style="height: 100%; text-align: center;position: relative; top: -12px; ">
                <div class=" flex1" id = "waterchart" style="height: 110px"></div>
                <div class="titlefont" style="font-size: 16px">4G超忙占比</div>
              </div>
           </dv-border-box-10>
           
             
          
         </div>
        <div class = "cbottom-box">
            <div class="gistitle">
              <span class="titlefont">{{gisTitle}}</span>
            </div>
            <iframe  ref="gisiframe" id="gisiframe" :src="iframeSrc"  style="width: 100%; height: 100%" frameborder="0"></iframe>
         </div>
      </div>
      <div class = "rightbox flex colflex">

         <div class = "box-item flex colflex " style="margin-bottom: 15px">
           <div class = "item-title titlefont">
             <span>套餐终端匹配情况</span>
           </div>
           <div  class = "flex1">
                
                <div class="rightTable">
                       <div class="tHead">
                         <div class="wid19"></div>
                         <div>3G终端</div>
                         <div>4G终端</div>
                         <div>4G终端</div>
                       </div>
                       <div class="tBody">
                         <div class="td wid19">
                           <div>3G套餐</div>
                           <div>4G套餐</div>
                           <div>5G套餐</div>
                         </div>
                         <div class="td bg" v-for="(item, idnex) in 3" :key="idnex">
                            <div class = "tdcell">{{item}}44343</div>
                            <div class = "tdcell">{{item}}44343</div>
                            <div class = "tdcell">{{item}}44343</div>
                         </div>
                       </div>
                     </div>
           </div>
         </div>
         <div class = "box-item flex colflex flex1">
           <div class = "item-title titlefont">
              <span>用户感知</span>
           </div>
          
             <div  class = "flex colflex">
              
              <div class="flex1 flex" style="margin-top: 10px">
                <div class="flex1">
                    <div class="chartbox" id = "yhgzchart1" style="height:150px"></div>
                    <div class = "piefont">4G信号良好覆盖率</div>
                </div>
                 <div class="flex1">
                     <div class="chartbox" id = "yhgzchart2" style="height:150px"></div>
                     <div class = "piefont">4G低速率基站占比</div>
                 </div>
              </div>
              <dv-decoration-10 style="width:90%;height:6px; margin: 15px auto" />
             
                 <div class="flex1">
                    <div class="flex1 flex" style="margin-top: 10px">
                        <div class="flex1">
                            <div class="chartbox" id = "gaugechart1" style="height:150px"></div>
                            <div class = "piefont2">
                              <div>4G平均下载速率</div>
                              <div class="sudubox "><span class="numfont">100</span> <span style="font-size: 18px">Mbps</span></div>
                            </div>
                        </div>
                        <div class="flex1">
                            <div class="chartbox" id = "gaugechart2" style="height:150px"></div>
                            <div class = "piefont2">
                              <div>4G平均上传速率</div>
                              <div class="sudubox "><span class="numfont">100</span> <span style="font-size: 18px">Mbps</span></div>
                            </div>
                        </div>
                    </div>
                  </div>
              
              <!-- <dv-decoration-10 style="width:90%;height:6px; margin: 15px auto" /> -->
              <div class="flex1" style="padding: 20px 15px">
                   <div class="flex">
                      <div class="flex1">
                         <dv-border-box-1>
                            <div class = "bitembox" >
                              <div class="numfont">88</div>
                              <img class="bimg" src="@/assets/resImg/tsrd.png"  alt="" srcset="">
                              <div class="infofont">投诉热点数量</div>
                            </div>
                          </dv-border-box-1>
                      </div>
                    
                    <div class="flex1" style="margin-left: 20px">
                       <dv-border-box-1>
                          <div class = "bitembox" >
                            <div class="numfont">8.8</div>
                            <img class="bimg" src="@/assets/resImg/myd.png"  alt="" srcset="">
                            <div class="infofont">CES满意度得分</div>
                          </div>
                       </dv-border-box-1>
                    </div>
                  </div>
              
                 
              </div>
            </div>
         </div>
        

      </div>
    </div>
      <el-dialog :visible.sync="isDialogShow" width="50%" :modal-append-to-body='false'>
        <div class="dialogCon">
          <div class="dialogTitle">
            <div class="left">简介</div>
          </div>
          <div class="dialogTableBg">
             
          </div>
        </div>
      </el-dialog>
       <Footer :tabdata="tabdata" class="initfoot"></Footer>
  </div>
</template>

<script>
var self = null
import Header from '@/components/resource_visual/header';
import Footer from '@/components/resource_visual/footer';
import store from 'store'
import { mapState } from 'vuex'
import echartInit from './wxfn_echart'
var _ = require('@/utils/lodash.js')

var Qs = require('@/utils/qs.js')
export default {
  data () {
    return {
      gisTitle: '山东省',
      
      isDialogShow: false,
     
      rowttabStatus: '1',
      rowttabStatus2: '1',
      bzhd_checkList: ['00', '01', '02'],
      cityCode: '370000',
      iframeSrc: '',
      tabstatus: '0201',
      gisQueryParams: {},
      queryParams: {},
      gisMapData: {},
      mapLevel: 1,
      areaCode: '',
      tabdata: [
        {title: '应急通信', active: false, href: '/resource_visual/cris_communication'},
        {title: '无线赋能', active: true, href: '/resource_visual/wireless_fn'},
      ],
    }
  },
  components: {
    Header,
    Footer,
   
  },
  created() {
    self = this;
  },
  mounted () {
     var initArea_id = ''
     if (store.get('userInfo')) {
         if (store.get('userInfo').gridId) {
          this.mapLevel = 4;
          initArea_id = store.get('userInfo').gridId
        } else if (store.get('userInfo').areaCode) {
          this.mapLevel = 3;
          initArea_id = store.get('userInfo').areaCode
        } else if (store.get('userInfo').eparchyCode && store.get('userInfo').eparchyCode != '0000') {
          this.mapLevel = 2;
          initArea_id = store.get('userInfo').eparchyCode
        } else {
          this.mapLevel = 1;
          initArea_id = '370000'
        };
        this.cityCode = initArea_id;
      }
    this.initGisMap(initArea_id);

     // 注册地图事件
    window.addEventListener('message',self.gismapListener, true);
    this.initService()
    this.initEchart()
  },
  watch: {
    
  },
  computed: {
    ...mapState({
       searchDate: state => state.resource.searchDate,
    }),
   
    
  },
  methods: {

    rowttabsClick (type) {
      this.rowttabStatus = type;
      
    },

    initService () {

    },
     
   
    gismapListener (e) {
      if (e.data.message == 'levelSwitch') {
         self.gisTitle = e.data.area_name || '山东省'
         self.mapLevel = e.data.level
         self.areaCode = e.data.area_id;
         self.gisMapData = e.data;
         self.gisQueryParams = Object.assign({},  self.gisQueryParams, e.data)
         self.gisQueryParams.area_name = '';
         console.log('message', e.data)
         self.cityCode = (e.data.area_id || '370000');
        //  self.initService()
      } else if (e.data.message == 'clickAct'){
         
      }
    },
    initGisMap (initArea_id) {
      // 初始化地图参数
        this.gisQueryParams =  {
             level: this.mapLevel,
              sceneid: 4,
              gis_sceneid: this.tabstatus,
              area_id: initArea_id,
              poi_city_id: '',
              system_type: 'C40',
              login_no:  store.get('staffId') || '',
              timest:  this.$store.state.resource.searchDate
          };
          var gisQueryParams = JSON.parse(JSON.stringify(this.gisQueryParams))
          this.iframeSrc = window.gis_iframeSrc +  `/smartEyes?${Qs.stringify(gisQueryParams)}`;
          
    },
    tabStatusFn (type) {
      this.tabstatus = type;
      var gisQueryParams = JSON.parse(JSON.stringify(this.gisQueryParams));
      gisQueryParams.message = "changeType";
      gisQueryParams.gis_sceneid = type;
      this.$refs['gisiframe'].contentWindow.postMessage(gisQueryParams, '*')
    },
    initEchart () {
        var pieparams1 = {
          domId: 'anipie1',
          value: 30,

        }
        new echartInit.initAnipie(pieparams1)

        var pieparams2 = {
          domId: 'anipie2',
          value: 60,

        }
        new echartInit.initAnipie(pieparams2)


        var pieparams3 = {
          domId: 'anipie3',
          value: 80,

        }
        new echartInit.initAnipie(pieparams3);

        var pieparams4 = {
          domId: 'compareBar1',
          value: 80,
        }
        new echartInit.initCompareBar(pieparams4)

         var pieparams5 = {
          domId: 'yhgzchart1',
          value: 80,
        }
        new echartInit.initAnipie(pieparams5)
        var pieparams52 = {
          domId: 'yhgzchart2',
          value: 80,
        }
        new echartInit.initAnipie(pieparams52)


        
        
        var chartparams1 = {
            domId: 'chartBarline1',
            legend: ['3G流量', '4G流量', '5G流量'],
            xData: [1, 2, 3, 4],
            barData: [100, 130, 340, 234],
            lineData: [
              [120, 150, 230, 134],
              [160, 230, 540, 634],
            ]
        }
        new echartInit.initEchart_barLine(chartparams1);


        var chartparams2 = {
          domId: 'chart_appph',
          uni: '%',
          data: [
            {'name': '抖音', val: 90},
            {'name': '微信', val: 83},
            {'name': '快手', val: 73},
            {'name': 'QQ', val: 73},
            {'name': '今日头条', val: 65},
            {'name': '爱奇艺', val: 61},
            {'name': '腾讯视屏', val: 56},
            {'name': '新浪微博', val: 43},
          ]
        }
        new echartInit.initEchart_pm(chartparams2)

         var chartparams3 = {
            domId: 'gaugechart1',
         }
         new echartInit.initecahrt_gauge(chartparams3)

         var chartparams32 = {
            domId: 'gaugechart2',
         }
         new echartInit.initecahrt_gauge(chartparams32)

         var wchartparams2 = {
           domId: 'waterchart',
           value: 40
         }

         new echartInit.initChart_water(wchartparams2)
         

        

        
   }
  },
  updated() {
     var self = this;
  },
  destroyed() { // 在组件生命周期结束的时候销毁。
    window.removeEventListener('message',this.gismapListener, true)
  }
}
</script>

<style lang='scss' scoped>
  @import url('../comtable.scss');
  .contentbody {
    height: 100%;
    background: url('~@/assets/images/bigScreen/bg-left.png') left no-repeat, url('~@/assets/images/bigScreen/bg-right.png') right no-repeat;
    background-size: auto 100%;
    margin: -30px 15px 10px 15px;
    position: relative;
    display: flex;
  }
 .leftbox,  .rightbox {
   width: 480px;
   height: 100%;
   box-sizing: border-box;
   padding: 15px;
   padding-bottom: 30px;
 }
 .centerbox {
  flex: 1;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
   background: url('~@/assets/images/images_zy/centerborder.png') no-repeat ;
   background-size: 100% 100%;
   margin-top: 10px;
   box-sizing: border-box;
   position: relative;
   padding: 40px 20px 20px 20px;
   margin-bottom: 80px;
  position: relative;

 }
.cbottom-box {
   flex: 1;
   margin-top: 10px;
   box-sizing: border-box;
   position: relative;
   padding-top: 50px;
   position: relative;
}

//  .item-title {
//    font-size: 22px;
//    color: aqua;
//    background: url('~@/assets/images/images_zy/itemtitle.png') no-repeat ;
//    background-size: 100% 100%;
//    line-height: 38px;
//     padding-left: 58px;
//     position: relative;
//  }

  .item-title {
  font-size: 18px;
   color: aqua;
   background: url('~@/assets/images/bigScreen/titlebg.png') no-repeat;
   background-size: 100% 100%;
   line-height: 46px;
   padding-left: 36px;
   margin-bottom: 5px;
   font-weight: bolder;
 }
 .chartbox {
   width: 100%;
   height: 100%;
 }

 .gdjkitem {
   height: 68px;
   width: 72px;
   margin: 0 auto;
   background: url('~@/assets/images/images_zy/cire.png') no-repeat;
  background-size: 100% 100%;
  line-height: 68px;
  font-size: 18px;
  text-align: center;
  font-weight: bolder;
  
 }

 .gdjkitembox {
   text-align: center;
   position: relative;
   margin-top: 12px;
   &:not(:last-child)::after{
     content: '';
     display: block;
     width: 18px;
     height: 18px;
     background: url('~@/assets/images/images_zy/jiantou.png') no-repeat;
     background-size: 100% 100%;
     position: absolute;
     right: -8px;
     top: 26px;
   }
 }


.mtheader {
    text-align: center;
    line-height: 40px;
    font-size: 16px;
    color: #51d1ee;
    border-bottom: 1px solid #308497;
   
}
.mtbody {
  height: 100%;
  margin: 6px 0;
  box-sizing: border-box;
  overflow: hidden;
}
.mtbody .scrollitem {
  text-align: center;
  height: 34px;
  line-height: 34px;
  padding: 0 5px;
}

.mtbody .scrollitem:nth-child(odd) {
  background: rgba(4,54,108,0.7);
}
 .centTab {
   position: absolute;
   z-index: 10;
   width: 100%;
   top: 30px;
   text-align: center;
  .centtabitem {
    display: inline-block;
    height: 56px;
    width: 140px;
    line-height: 66px;
    text-align: center;
    font-size: 18px;
    cursor: pointer;
    color: rgb(2, 252, 252);
     background: url('~@/assets/images/images_zy/WechatIMG431.png') no-repeat;
    background-size: 100% 120%;
    margin-right: -15px;
    opacity: 0.5;
    
   }
    .centtabitem.active {
       opacity: 1;
    }
 }
 .tunit {
   font-size: 16px;
 }


 .cardetailbox {
   display: flex;
   padding: 15px 0;
   .imgbox {
     margin-right: 30px;
     width: 380px;
     img {
       width: 380px;
       height: 250px; 
     }
   }
   .fontbox {
     color: #fff;
     font-size: 16px;
   }
 }
 /deep/.el-table tbody tr.rowclassname_00  td{
   color: rgb(243, 198, 101)!important;
 }
  /deep/.el-table tbody tr.rowclassname_01  td{
   color: rgb(92, 235, 74)!important;
 }
  /deep/.el-table tbody tr.rowclassname_02  td{
   color: rgb(86, 212, 243)!important;
 }

 .checkgroupbox {
   position: absolute;
   right: 10px;
   top: 0;
 }
 .checkgroupbox .el-checkbox {
   margin-right: 15px;
   .el-checkbox__label {
     margin-left: 6px;
   }
 }
  /deep/ .checkstate01 .el-checkbox__label {
     color: rgb(92, 235, 74)!important;
  }
   /deep/ .checkstate00 .el-checkbox__label {
     color: rgb(243, 198, 101)!important;
  }
  /deep/ .checkstate02 .el-checkbox__label {
    color: rgb(86, 212, 243)!important;
  }

  /deep/ #bzhdTable tbody tr {
    cursor: pointer !important;
  }

  .box-item {
  position: relative;
}
  .rowttabs {
   height: 40px;
  line-height: 40px;
  position: absolute;
  top: 0;
  right: 0;
  .rowttabs-item {
    padding: 4px 8px;
    border-radius: 5px;
    border: 1px solid #5b7bc9;
    margin-left: 10px;
    color: #698bdf;
    cursor: pointer;
  }
  .rowttabs-item.active {
    border: 1px solid #45d8e2;
     color: #45d8e2;
  }
 }
/deep/ .el-dialog {
  -webkit-transform: none;
  transform: none;
  left: 0;
  position: relative;
  z-index: 20000;
  margin: 0 auto;
  padding-bottom: 30px;
  background-image: url('~@/assets/images/bigScreen/kuang.png');
  background-size: 100% 100%;
  background-color: rgba(220, 38, 38, 0);
}

/deep/ .el-dialog__body {
  padding: 0px 20px;
}
/deep/ .el-dialog__headerbtn .el-dialog__close {
  color: #fff;
  font-size: 24px;
  font-weight: 500;
  margin: 2px 20px 0 0;
  border: 2px solid #193987;
  border-radius: 5px;
  background: #1e1e88;
}
 .dialogCon {
  padding: 0 40px;
  .dialogTitle {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-right: 30px;
    .left {
      display: inline-block;
      padding-right: 110px;
      font-size: 24px;
      font-family: MFBanHei;
      font-weight: 400;
      color: #02f6ff;
      background-image: url('~@/assets/images/bigScreen/fullService/Rectangle 561.png');
      background-repeat: no-repeat;
      background-position: center right;
    }
    .title-right {
      color: #218cc8;
      font-size: 12px;
      font-family: Microsoft YaHei;
      div {
        width: 38px;
        height: 30px;
        line-height: 30px;
        text-align: center;
        display: inline-block;
        cursor: pointer;
        background-image: url('~@/assets/images/bigScreen/fullService/left-sub.png');
        background-repeat: no-repeat;
        background-size: 100% 100%;
      }
      .active {
        color: #02f6ff;
        background-image: url('~@/assets/images/bigScreen/fullService/left-subActive.png');
      }
    }
  }
}
.hddetali {
  padding: 10px;
  color: #fff;
  font-size: 14px;
  overflow: auto;
  height: 320px;
  h3 {
     color: #fff;
  }
}
.swiperClass {
  width: 80%;
  height: 280px;
  margin:  0 auto;
  .swiper-slide {
    img {
      width: 100%;
      height: 100%;
    }
  }
}

.swiper-pagination-bullet-active {
    opacity: 1;
    background: #19daec;
}
.swiper-pagination-bullet {
  opacity: 0.5;
  width: 12px;
  height: 12px;
}

.gistitle {
 position: absolute;
  left: 20px;
  top: 10px;
  font-size: 24px;
  color: aqua;

}
.anpiebox {
  height: 140px;
}
.piefont {
  font-size: 15px;
  line-height: 38px;
  text-align: center;
}


.rightTable {
      width: 100%;
      font-size: 14px;
      font-family: Arial, Helvetica, sans-serif;
      color: #02f6ff;
      .tHead,.tBody {
        display: flex;
        .wid19 {
          width: 18% !important;
          text-align: left;
        }
      }
      .tHead {
        line-height: 38px;
        div {
          width: 27%;
          text-align: center;
          background-image: url('~@/assets/images/bigScreen/fullService/597bcdc505fa3.png');
          background-repeat: no-repeat;
          background-size: 100% 100%;
          background-position: center 12px;
           font-weight: bolder;
        }
        .wid19 {
          background-image: none;
        }
      }
      .tBody {
        .td {
          width: 27%;
          text-align: center;
          div {
            // padding: 10px 0;
            line-height: 40px;
            border-bottom: 1px dashed #134192;
          }
        }
        .bg {
          background-image: url('~@/assets/images/bigScreen/fullService/Shape 1387.png');
          background-repeat: no-repeat;
          background-position: center left;
          background-size: 1px 100%;
          div {
            font-size: 15px;
            font-family: DigifaceWide;
            color: #ffffff;
          }
        }
      }
    }
    .piefont2 {
      position: relative;
      top: -10px;
      text-align: center;
      font-size: 15px;
      .sudubox {
        font-size: 22px;
        color: rgb(240, 161, 15);
      }

    }
    .bitembox {
      margin: 0 auto;
      text-align: center;
      .bimg {
        margin: 10px 0;
        width: 68px;
        height: 60px;
      }
      .numfont {
        font-size: 22px;
        color: aqua;
      }
      .infofont {
        font-size: 16px;
      }
    }
   /deep/.border-box-content {
      padding: 15px 10px;
      display: flex;
      align-items: center;
      justify-self: center;
    }
    .rowtitem {
      display: flex;
      flex-direction: column;
      align-items: center;
      .sub_rowtitem {
        display: flex;
        margin-bottom: 10px;
        .inconbox {
          margin-right: 40px;
          width: 42px;
          height: 42px;
          background: #031962;
          text-align: center;
          border-radius: 50%;
          box-shadow: 0 0 10px rgba(53, 98, 233, 0.8);
          margin-bottom: 10px;
          position: relative;
          top: 5px;
          img {
            width: 40px;
          }
        }
        .flex1 {
          text-align: center;
        }
        .numfont {
          color: rgb(241, 169, 13);
          font-size: 20px;
        }
        .titlefont {
          font-size: 16px;
        }

      }
    }
    .rowtitem1 {
      flex: 1.2;
    }
</style>