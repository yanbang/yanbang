<!--  -->
<template>
  <div class="contentbox">
    <comheader
      v-if="or_he == '0'"
      backurl="/unicomwisdomeyes/yhzl_index"
      title="山东联通网络智慧眼-沿黄战略"
      subtitle="网络能力"
    ></comheader>
    <comheader v-else title="山东联通网络智慧眼-网" subtitle="承载"></comheader>
    <div class="contentbody">
      <div class="left-content">
        <div class="flex1 flexitem-box flex colflex">
          <div class="item-title titlefont">
            网络能力
          </div>
          <div class="flex  colflex">
            <div class="flex1" style="position: relative;">
              <div class="clearfix" style="line-height: 32px; position: relative">
                <div class="subtitlegg">
                  <span>设备</span>
                  <span v-show="mapLevel != 1 || or_he == '0'" style="margin-left: 10px">(全省)</span>
                </div>
                <!-- <span class="zdmore pull-right" @click="dialogShow5 = true"><span class="el-icon-more"></span></span> -->
              </div>
              <div class="flex kjzybox" style="padding: 25px 0 ">
                <div class="flex1">
                  <div class="numfont">
                    {{ sbdata.num_cr | formatVal }}
                    <span class="unit">(台)</span>
                  </div>
                  <div><img src="@/assets/images/cr.png" alt="" srcset="" /></div>
                  <div class="kjzyinfo">CR</div>
                </div>
                <div class="flex1">
                  <div class="numfont">{{ sbdata.num_bras | formatVal }} <span class="unit">(台)</span></div>
                  <div><img src="@/assets/images/images_zy/iconimg2.png" alt="" srcset="" /></div>
                  <div class="kjzyinfo">BRAS</div>
                </div>
                <div class="flex1">
                  <div class="numfont">{{ sbdata.num_er | formatVal }} <span class="unit">(台)</span></div>
                  <div><img src="@/assets/images/images_zy/交换机.png" alt="" srcset="" /></div>
                  <div class="kjzyinfo">大二层交换机</div>
                </div>
              </div>
            </div>
            <div class="flex1 colflex">
              <div class="topboxchart">
                <div class="subtitlebox">
                  <div class="subtitlegg">
                    <span>传输</span>
                    <span v-show="mapLevel > 2" style="margin-left: 10px">(市级)</span>
                  </div>
                  <span class="zdmore pull-right" style="top: 5px" @click="csDetailFn"
                    ><span class="el-icon-more"></span
                  ></span>
                </div>
                <div class="chartbox flex1" id="chart_cspie"></div>
              </div>
            </div>
            <div class="xlbox boxshadowitem ">
              <div class="subtitlebox">
                <div class="subtitlegg">
                  <span>线路</span>
                  <span v-show="mapLevel > 2" style="margin-left: 10px">(市级)</span>
                </div>
                <span class="zdmore pull-right" @click="xldetailFn"><span class="el-icon-more"></span></span>
              </div>
              <!-- <div class="rowttabs trowttabs">
                <span class="rowttabs-item" :class="{ active: rt1status == '1' }" @click="rt1status = '1'">线路</span>
                <span class="rowttabs-item" :class="{ active: rt1status == '2' }" @click="rt1status = '2'">接入网</span>

                <span class="zdmore pull-right" v-if="rt1status == '1'" @click="dialogShow2 = true"><span class="el-icon-more"></span></span>
                <span class="zdmore pull-right" v-if="rt1status == '2'" @click="dialogShow3 = true"><span class="el-icon-more"></span></span>
              </div> -->

              <div class="chartbox">
                <div class="ltforege flex colflex">
                  <div class="flex1 clearfix">
                    <div class="ggitembox xlbodyrow1">
                      <div class="subtitlegg2">
                        <span>皮长公里数</span>
                      </div>
                      <div class="chartbox">
                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl2.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">一干:</span>
                            <span class="nunfont">{{ netXlData.one_pi || 0 }}</span>
                          </div>
                        </div>
                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl2.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">二干:</span>
                            <span class="nunfont">{{ netXlData.two_pi || 0 }}</span>
                          </div>
                        </div>

                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">本地中继:</span>
                            <span class="nunfont">{{ netXlData.zhong_pi || 0 }}</span>
                          </div>
                        </div>
                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">本地接入:</span>
                            <span class="nunfont">{{ netXlData.yin_pi || 0 }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="ggitembox ggitembox2">
                      <div class="subtitlegg2">
                        <span>纤芯公里数</span>
                      </div>
                      <div class="chartbox">
                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl2.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">一干:</span>
                            <span class="nunfont">{{ netXlData.one_xin || 0 }}</span>
                          </div>
                        </div>
                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl2.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">二干:</span>
                            <span class="nunfont">{{ netXlData.two_xin || 0 }}</span>
                          </div>
                        </div>
                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">本地中继:</span>
                            <span class="nunfont">{{ netXlData.zhong_xin || 0 }}</span>
                          </div>
                        </div>
                        <div class="xlitem flex">
                          <div>
                            <img
                              style="width: 30px; height: 28px"
                              src="@/assets/images/images_zy/gl.png"
                              alt=""
                              srcset=""
                            />
                          </div>
                          <div class="flex1">
                            <span class="leftttt">本地接入:</span>
                            <span class="nunfont">{{ netXlData.yin_xin || 0 }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- 
              <div class = "xlbox boxshadowitem">
                <div class="clearfix" style="line-height: 32px">
                  <div class = "subtitlegg">
                       <span>数据</span>
                  </div>
                   <span class="zdmore pull-right" @click="dialogShow4 = true"><span class="el-icon-more"></span></span>
                </div>
                 
                  <div  class="chartbox flex colflex" style="padding-top: 10px;">
                    <div class = "flexrow1 flex">
                       <div class="flex1">
                         <div class="itemttil">BRAS数<span class="unit">(台)</span></div>
                         <div class = "numfont">{{qwsjData.bras_num || '-'}}</div>
                       </div>
                       <div class="flex1">
                         <div  class="itemttil">在线用户数<span class="unit">(万)</span></div>
                         <div class = "numfont">{{qwsjData.online_user_num || '-'}}</div>
                       </div>
                       <div class="flex1">
                         <div  class="itemttil">CR出口带宽<span class="unit">(G)</span></div>
                         <div class = "numfont">{{qwsjData.cr_exit_width || '-'}}</div>
                       </div>
                    </div>
                    <div class="charrow flex">
                      <div class="flex1">
                         <div class="waterCharbox" id="watercahrt1"></div>
                         <div class = "waterinfo">BRAS地址池利用率</div>
                       </div>
                       <div class="flex1">
                       
                         <div class="waterCharbox waterCharbox2">
                           <div style="color: #13f413">
                             <span class = "lineinfo">流入：</span>
                             <span>{{qwsjData.bras_on_rate_into || 0}}%</span>
                           </div>
                           <div style="color: #96cae8">
                             <span  class = "lineinfo">流出：</span>
                             <span>{{qwsjData.bras_on_rate_out || 0}}%</span>
                           </div>
                         </div>
                         <div class = "waterinfo">BRAS上联中继利用率</div>
                       </div>
                       <div class="flex1">
                         <div class="waterCharbox waterCharbox2">
                           <div style="color: #13f413">
                             <span  class = "lineinfo">流入：</span>
                             <span>{{qwsjData.cr_on_rate_into || 0}}%</span>
                           </div>
                           <div style="color: #96cae8">
                             <span  class = "lineinfo">流出：</span>
                             <span>{{qwsjData.cr_on_rate_out || 0}}%</span>
                           </div>
                         </div>
                         <div class = "waterinfo">CR上联中继利用率</div>
                       </div>

                    </div>
                  </div>
              </div> -->
          </div>
        </div>
      </div>

      <div class="center-content">
        <div class="ctop-box flex">
          <dv-border-box-12 class="flex tcwarp">
            <div class="flex1 flex colflex">
              <div class="item-title titlefont" style="width: 450px; line-height: 38px; position: relative">
                <span> 资源</span>
                <span v-show="mapLevel > 2" style="margin-left: 10px">(市级)</span>
                <span class="zdmore pull-right" @click="zydetailFn"><span class="el-icon-more"></span></span>
              </div>
              <div class="flex1 flex" style="margin-bottom: 4px">
                <div class="flex1 tcinfoitem">
                  <div class="tinfo titlefont">互联网专线数</div>
                  <div class="numfont">{{ formatNumber(netZylData.internetCircuitCnt) || 0 }}</div>
                </div>
                <div class="flex1 tcinfoitem">
                  <div class="tinfo titlefont">以太网专线数</div>
                  <div class="numfont">{{ formatNumber(netZylData.numCircuitCnt) || 0 }}</div>
                </div>
                <!-- <div class="flex1 tcinfoitem">
                  <div class="tinfo titlefont">等5类电路数</div>
                  <div class="numfont">{{ formatNumber(netZylData.base_station_3g) || 0 }}</div>
                </div> -->
                <div class="flex1 tcinfoitem">
                  <div class="tinfo titlefont">光路数量</div>
                  <div class="numfont">{{ formatNumber(netZylData.guanglu_num) || 0 }}</div>
                </div>
                <!-- <div class="flex1 tcinfoitem">
                  <div class="tinfo titlefont">5G基站数<span class="unit">(个)</span></div>
                  <div class="numfont">{{ formatNumber(netZylData.base_station_5g) || 0 }}</div>
                </div> -->
              </div>
            </div>
          </dv-border-box-12>
        </div>
        <!-- 新需求 -->
        <div class="cbottom-box" style="position: relative">
          <div class="tjbtn" @click="getEyesInfo"><img src="../zhyeys.png" alt="" srcset="" /></div>
          <div class="centTab2">
            <div class="centtabitem titlefont" :class="{ active: tabstatus_new == '1' }" @click="tabStatusFn_new('1')">
              <span>光缆网络图</span>
            </div>
            <div class="centtabitem titlefont" :class="{ active: tabstatus_new == '2' }" @click="tabStatusFn_new('2')">
              <span>数据拓扑图</span>
            </div>
            <el-dropdown class="initdropdown" @command="dropdownSelect1">
              <div class="centtabitem titlefont" :class="{ active: tabstatus_new == '3' }">
                传输拓扑图
              </div>
              <el-dropdown-menu slot="dropdown" class="initdropdownmenu">
                <el-dropdown-item command="1">山东联通省内干线100G OTN网络拓扑图</el-dropdown-item>
                <el-dropdown-item command="2">山东联通省内干线WDM 40G网络拓扑图</el-dropdown-item>
                <el-dropdown-item style=" border: none;" command="3"
                  >山东联通省内干线ASON系统网络拓扑图</el-dropdown-item
                >
              </el-dropdown-menu>
            </el-dropdown>
            <el-dropdown class="initdropdown" @command="dropdownSelect2">
              <div class="centtabitem titlefont" :class="{ active: tabstatus_new == '4' }">
                IPTV拓扑图
              </div>
              <el-dropdown-menu slot="dropdown" class="initdropdownmenu">
                <el-dropdown-item command="4">中兴ITPV拓扑图</el-dropdown-item>
                <el-dropdown-item command="5">华为ITPV拓扑图</el-dropdown-item>
              </el-dropdown-menu>
            </el-dropdown>
          </div>
          <div class="gistitle">
            <span class="titlefont">{{ gisTitle }}</span>
          </div>
          <iframe
            v-show="tabstatus_new == '1'"
            ref="gisiframe"
            id="gisiframe"
            :src="iframeSrc"
            style="width: 100%; height: 100%"
            frameborder="0"
          ></iframe>

          <iframe
            v-show="tabstatus_new == '2'"
            ref="gisiframe"
            id="gisiframe2"
            :src="iframeSrc2"
            style="width: 100%; height: 100%"
            frameborder="0"
          ></iframe>
          <div class="conttuopu2" v-show="tabstatus_new == '3' || tabstatus_new == '4'">
            <img :src="tpimgsrc" />
          </div>
        </div>

        <!-- <div class="cbottom-box" style="position: relative">
          <div class="tjbtn" @click="getEyesInfo"><img src="../zhyeys.png" alt="" srcset="" /></div>
          <div class="centTab">
            <div class="centtabitem titlefont" :class="{'active': tabstatus == '0201'}" @click="tabStatusFn('0201')">
              <span>GIS</span>
            </div>
            <div class="centtabitem titlefont" :class="{'active': tabstatus == '0202'}" @click="tabStatusFn('0202')">
              <span style="">拓扑</span>
               <el-menu 
              :default-active="activeIndex" class="el-menu-demo zelmenu"
               mode="horizontal" @select="tabStatusFn1" style="z-index: 999;"
                    background-color="rgba(1,132,254,0.05)"
                    text-color="#00eaff"
                    active-text-color="#rgba(1,132,254,0.5)"
              >
                 <el-submenu index="1">
                  <template slot="title"></template>
                  <el-menu-item index="1-1">IP承载A网</el-menu-item>
                  <el-menu-item index="1-2">IP承载B网</el-menu-item>
                  <el-menu-item index="1-3">C</el-menu-item>
                 </el-submenu>
               </el-menu>
            </div>
          </div>
          <div class="gistitle">
            <span class="titlefont">{{ gisTitle }}</span>
          </div>
          <iframe
           v-show="tabstatus == '0201'"
            ref="gisiframe"
            id="gisiframe"
            :src="iframeSrc"
            style="width: 100%; height: 100%"
            frameborder="0"
          ></iframe>
          <div class="conttuopu"  v-show="tabstatus == '0202'">
            <img :src="conttuopuimgobj.conttuopuimg" />
          </div>

        </div> -->
      </div>
      <div class="right-content">
        <div class=" flex colflex flexitem-box flex1">
          <div class="item-title titlefont">
            带宽利用率 <span v-show="mapLevel != 1" style="margin-left: 10px">(全省)</span>
          </div>

          <!-- <div class = "flex1 flex">
                 <div class="flex1 matitembox" style="text-align: center">

                    <dv-decoration-12 style="width:120px;height:120px; margin: 0 auto">
                        <div class="matbox">
                            <div class="matfont">{{gzxlData.one_fault_num}}</div>
                        </div>
                    </dv-decoration-12>
                     <div class="mattitle">一 干</div>  
                 </div>
                 <div class="flex1 matitembox">
               
                    <dv-decoration-12 style="width:120px;height:120px; margin: 0 auto">
                        <div class="matbox">
                            <div class="matfont">{{gzxlData.two_fault_num}}</div>
                        </div>
                    </dv-decoration-12>
                     <div class="mattitle">二 干</div>  
                 </div>
                   <div class="flex1 matitembox">
                 
                    <dv-decoration-12 style="width:120px;height:120px; margin: 0 auto">
                        <div class="matbox">
                            <div class="matfont">{{gzxlData.local_fault_num}}</div>
                        </div>
                    </dv-decoration-12>
                     <div class="mattitle">本 地</div>  
                 </div>
              </div> -->
          <div class="flex1 flex">
            <div class="chartbox" id="chart_line12"></div>
          </div>
        </div>

        <div class="flex1 flex colflex flexitem-box">
          <div class="item-title titlefont">
            传输出租电路完整性指标
            <span v-show="mapLevel != 1" style="margin-left: 10px">(全省)</span>
          </div>

          <div class="flex1">
            <div id="chart_wycb" class="chartbox"></div>
          </div>
        </div>

        <div class="flex1 flexitem-box flex colflex flex">
          <div class="item-title titlefont">
            线路赔补<span class="tunit">(万元)</span>
            <span v-show="mapLevel > 2" style="margin-left: 10px">(市级)</span>
          </div>
          <div class="flex1">
            <div id="chart_rightxlpb" class="chartbox"></div>
          </div>
        </div>
        <!-- <div class="flex colflex flexitem-box" style="height: 200px">
          <div class="item-title titlefont">
            <span>匠心网络</span>
            <span class="zdmore pull-right" @click="dialogShow7 = true"><span class="el-icon-more"></span></span>
          </div>
          <div class="flex flex1 colflex">
            <div class="flex1 jxwlrow flex">
              <div class="flex1">
                <div>
                  <span class="numfont">{{ qwJxwlData.reach_standard || '-' }}</span>
                  <span class="unit">%</span>
                </div>
                <div>
                  <img src="@/assets/images/达标分析.png" alt="" srcset="" />
                </div>
                <div class="jxinfo">达标1.0</div>
              </div>
              <div class="flex1">
                <div>
                  <span class="numfont">{{ qwJxwlData.resource_visual || '-' }}</span>
                  <span class="unit">%</span>
                </div>
                <div>
                  <img src="@/assets/images/zyksh.png" alt="" srcset="" />
                </div>
                <div class="jxinfo">资源可视化</div>
              </div>
              <div class="flex1">
                <div>
                  <span class="numfont">{{ qwJxwlData.reach_standard_num || '-' }}</span>
                  <span class="unit">%</span>
                </div>
                <div>
                  <img src="@/assets/images/可视化.png" alt="" srcset="" />
                </div>
                <div class="jxinfo">数字化转型达标</div>
              </div>
            </div>
          </div>
        </div>
        <div class="flex1 flex colflex flexitem-box">
          <div class="item-title titlefont">
            <span>匠心网络-移网</span>
            <span class="zdmore pull-right" @click="dialogShow8 = true"><span class="el-icon-more"></span></span>
          </div>
          <div class="flex flex1 colflex" style="padding-bottom: 10px">
            <div class="flex1 jxwlrow jxwlrow2 flex">
              <div class="flex1">
                <div>
                  <span class="numfont">{{ qwJxwlData.scene_satisfy || '-' }}</span>
                  <span class="unit">分</span>
                </div>
                <div>
                  <img src="@/assets/images/myd.png" alt="" srcset="" />
                </div>
                <div class="jxinfo">场景满意度</div>
              </div>
              <div class="flex1">
                <div>
                  <span class="numfont">{{ qwJxwlData.network_improve || '-' }}</span>
                  <span class="unit">分</span>
                </div>
                <div>
                  <img src="@/assets/images/达标.png" alt="" srcset="" />
                </div>
                <div class="jxinfo">4G/5G网络提升</div>
              </div>
              <div class="flex1">
                <div>
                  <span class="numfont">{{ qwJxwlData.network_maintain || '-' }}</span>
                  <span class="unit">分</span>
                </div>
                <div>
                  <img src="@/assets/images/维护.png" alt="" srcset="" />
                </div>
                <div class="jxinfo">网络维护能力</div>
              </div>

              <div class="flex1" style="flex: 1.2">
                <div>
                  <span class="numfont">{{ qwJxwlData.voice_improve || '-' }}</span>
                  <span class="unit">分</span>
                </div>
                <div>
                  <img src="@/assets/images/zlts.png" alt="" srcset="" />
                </div>
                <div class="jxinfo">语音专线质量提升</div>
              </div>
            </div>
          </div>
        </div> -->
      </div>
    </div>
    <el-dialog :visible.sync="dialogShow1" width="90%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">网络能力</div>
        </div>
        <div class="dialogTableBg">
          <div class="flex">
            <div class="flex1">
              <div class="tbtitle">传输</div>

              <el-table
                class="inittable2 custom_table groupheadtable"
                :data="cs_tabledata2"
                v-loading="zydeshow"
                height="680px"
                size="mini"
                style="width: 100%"
              >
                <el-table-column prop="name" label="地市"> </el-table-column>
                <el-table-column label="IPRAN">
                  <el-table-column prop="ipran_enum" sortable label="设备数"> </el-table-column>
                  <el-table-column prop="ipran_num" sortable label="端口数"> </el-table-column>
                  <el-table-column prop="ipran_rate" sortable label="端口占用率">
                    <template slot-scope="scope">
                      <span>{{ scope.row.ipran_rate }}%</span>
                    </template>
                  </el-table-column>
                </el-table-column>
                <el-table-column label="SDH">
                  <el-table-column prop="sdh_enum" sortable label="设备数"> </el-table-column>
                  <el-table-column prop="shd_num" sortable label="端口数"> </el-table-column>
                  <el-table-column prop="shd_rate" sortable label="端口占用率">
                    <template slot-scope="scope">
                      <span>{{ scope.row.shd_rate }}%</span>
                    </template>
                  </el-table-column>
                </el-table-column>
                <el-table-column label="OTN">
                  <el-table-column prop="otn_enum" sortable label="设备数"> </el-table-column>
                  <el-table-column prop="otn_num" sortable label="端口数"> </el-table-column>
                  <el-table-column prop="otn_rate" sortable label="端口占用率">
                    <template slot-scope="scope">
                      <span>{{ scope.row.otn_rate }}%</span>
                    </template>
                  </el-table-column>
                </el-table-column>
              </el-table>
            </div>
          </div>
        </div>
      </div>
    </el-dialog>

    <el-dialog :visible.sync="dialogShow2" width="80%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">网络能力-线路详情</div>
        </div>
        <div class="dialogTableBg">
          <div class="flex">
            <div class="flex1">
              <el-table
                class="custom_table grouptable groupheadtable"
                size="mini"
                :data="xl_tabledata"
                height="720px"
                style="width: 100%"
                v-loading="xlloading"
              >
                <el-table-column prop="name" label="地市"> </el-table-column>
                <el-table-column label="皮长公里数">
                  <el-table-column prop="one_pi" sortable label="一干"> </el-table-column>
                  <el-table-column prop="two_pi" sortable label="二干"> </el-table-column>
                  <el-table-column prop="zhong_pi" sortable label="本地中继"> </el-table-column>
                  <el-table-column prop="yin_pi" sortable label="本地接入"> </el-table-column>
                </el-table-column>

                <el-table-column label="纤芯公里数">
                  <el-table-column prop="one_xin" sortable label="一干"> </el-table-column>
                  <el-table-column prop="two_xin" sortable label="二干"> </el-table-column>
                  <el-table-column prop="zhong_xin" sortable label="本地中继"> </el-table-column>
                  <el-table-column prop="yin_xin" sortable label="本地接入"> </el-table-column>
                </el-table-column>
              </el-table>
            </div>
          </div>
        </div>
      </div>
    </el-dialog>

    <el-dialog :visible.sync="dialogShow3" width="80%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">网络能力-接入网</div>
        </div>
        <div class="dialogTableBg">
          <el-table class="inittable2" :data="jrw_tabledata" size="mini" height="720px" style="width: 100%">
            <el-table-column prop="name" label="地市"> </el-table-column>
            <el-table-column prop="one_splitter" sortable label="一级分光器"> </el-table-column>
            <el-table-column prop="one_splitter_port" sortable label="一级分光器端口"> </el-table-column>
            <el-table-column prop="two_splitter" sortable label="二级分光器"> </el-table-column>
            <el-table-column prop="two_splitter_port" sortable label="二级分光器端口"> </el-table-column>
            <el-table-column prop="iptv_user_num" sortable label="IPTV用户"> </el-table-column>
            <el-table-column prop="broadband_user_num" sortable label="宽带用户"> </el-table-column>
            <el-table-column prop="olt_num" sortable label="OLT设备"> </el-table-column>
          </el-table>
        </div>
      </div>
    </el-dialog>

    <el-dialog :visible.sync="dialogShow4" width="80%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">网络能力-数据</div>
        </div>
        <div class="dialogTableBg">
          <el-table
            class="custom_table grouptable groupheadtable"
            size="mini"
            :data="sj_tabledata"
            height="720px"
            style="width: 100%"
          >
            <el-table-column prop="name" label="地市"> </el-table-column>
            <el-table-column prop="bras_num" sortable label="BRAS数(台)"> </el-table-column>
            <el-table-column prop="online_user_num" sortable label="在线用户数(万)"> </el-table-column>
            <el-table-column prop="cr_exit_width" sortable label="CR出口带宽(G)"> </el-table-column>
            <el-table-column prop="bras_pool_rate" sortable label="BRAS地址池利用率">
              <template slot-scope="scope">
                <span>{{ scope.row.bras_pool_rate }}%</span>
              </template>
            </el-table-column>
            <el-table-column label="BRAS上联中继利用率">
              <el-table-column prop="bras_on_rate_into" sortable label="流入">
                <template slot-scope="scope">
                  <span>{{ scope.row.bras_on_rate_into }}%</span>
                </template>
              </el-table-column>
              <el-table-column prop="bras_on_rate_out" sortable label="流出">
                <template slot-scope="scope">
                  <span>{{ scope.row.bras_on_rate_out }}%</span>
                </template>
              </el-table-column>
            </el-table-column>
            <el-table-column label="CR上联中继利用率">
              <el-table-column prop="cr_on_rate_into" sortable label="流入">
                <template slot-scope="scope">
                  <span>{{ scope.row.cr_on_rate_into }}%</span>
                </template>
              </el-table-column>
              <el-table-column prop="cr_on_rate_out" sortable label="流出">
                <template slot-scope="scope">
                  <span>{{ scope.row.cr_on_rate_out }}%</span>
                </template>
              </el-table-column>
            </el-table-column>
          </el-table>
        </div>
      </div>
    </el-dialog>

    <el-dialog :visible.sync="dialogShow5" width="60%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">网络能力-空间资源</div>
        </div>
        <div class="dialogTableBg">
          <el-table class="inittable2" :data="kjzy_tabledata" size="mini" height="720px" style="width: 100%">
            <el-table-column prop="name" label="地市"> </el-table-column>
            <!-- <el-table-column prop="idc_com_num" sortable label="IDC机房数"> </el-table-column> -->
            <el-table-column prop="station_core" sortable label="核心局站点"> </el-table-column>
            <el-table-column prop="station_convergence" sortable label="汇聚局站数"> </el-table-column>
            <el-table-column prop="station_inthis" sortable label="接入局站数"> </el-table-column>
            <!-- <el-table-column prop="base_com_num" sortable label="基站机房数"> </el-table-column> -->
          </el-table>
        </div>
      </div>
    </el-dialog>

    <el-dialog :visible.sync="dialogShow6" width="60%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">资源详情</div>
        </div>
        <div class="dialogTableBg" style="min-height: 600px">
          <el-table
            class="inittable2"
            :data="czy_tabledata"
            size="mini"
            v-loading="zydeshow"
            style="width: 100%"
            show-summary="true"
          >
            <el-table-column prop="name" label="地市"> </el-table-column>
            <el-table-column prop="internetCircuitCnt" sortable label="互联网专线数"> </el-table-column>
            <el-table-column prop="numCircuitCnt" sortable label="以太网专线数"> </el-table-column>
            <el-table-column prop="guanglu_num" sortable label="光路数量"> </el-table-column>
            <!-- <el-table-column prop="base_station_4g" sortable label="4G基站数"> </el-table-column>
            <el-table-column prop="base_station_5g" sortable label="5G基站数"> </el-table-column> -->
          </el-table>
        </div>
      </div>
    </el-dialog>

    <el-dialog :visible.sync="zhyDshow" width="50%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">承载-智慧眼</div>
        </div>
        <div class="dialogTableBg" style="min-height: 400px; max-height: 600px; overflow: auto">
          <div class="eyesmodelbox" v-html="zhy_content"></div>
        </div>
      </div>
    </el-dialog>

    <el-dialog :visible.sync="kdlylIshow" width="80%" :modal-append-to-body="false">
      <div class="dialogCon">
        <div class="dialogTitle">
          <div class="left">带宽利用率详情</div>
        </div>
        <div class="dialogTableBg" style="min-height: 600px">
          <el-table class="inittable2" :data="kdlylData" v-loading="zydeshow" size="mini" style="width: 100%">
            <el-table-column prop="name" label="地市"> </el-table-column>
            <el-table-column prop="rate_fgq" label="分光器端口利用率"> </el-table-column>
            <el-table-column prop="rate_olt" label="OTL端口利用率"> </el-table-column>
            <el-table-column prop="rate_brasin" label="BRAS上联中继利用率流入"> </el-table-column>
            <el-table-column prop="rate_brasout" label="BRAS上联中继利用率流出"> </el-table-column>
            <el-table-column prop="rate_crin" label="CR上联中继利用率流入"> </el-table-column>
            <el-table-column prop="rate_crout" label="CR上联中继利用率流出"> </el-table-column>
          </el-table>
        </div>
      </div>
    </el-dialog>

    <Footer v-if="or_he == '0'" :tabdata="tabdata" class="initfoot"></Footer>
  </div>
</template>

<script>
import echartInit from '@/views/resource_visual/network/echartInit'
import comheader from '@/components/resource_visual/header2'
import Footer from '@/components/resource_visual/footer'
import store from 'store'
import { mapState } from 'vuex'
import serviceApi from '@/api/network/indexscreen'
import serviceApis from '@/api/network/wireless'
import waterPoloChart from '@/views/resource_visual/echarts_component/waterPoloChart'
import echarts_init from '../fu/echart_lines'
import conttuopuimg from '@/assets/images/tuopu1.png'
import conttuopuimg2 from '@/assets/images/tuopu2.png'
import { reduce } from 'store/storages/all'

var _ = require('@/utils/lodash.js')
var Qs = require('@/utils/qs.js')
var echartResie1 = null
var echartResie2 = null
export default {
  data() {
    return {
      tpimgsrc: '',
      tabstatus_new: '1',
      conttuopuimgobj: {
        conttuopuimg: conttuopuimg,
        conttuopuimg1: conttuopuimg,
        conttuopuimg2: conttuopuimg2
      },
      zydeshow: false,
      zhyDshow: false,

      gisTitle: '山东省',
      rt1status: '1',
      qwsjData: {},
      tabdata: [
        {
          title: '移网',
          active: false,
          href: '/unicomwisdomeyes/network_wireless?pagesource=yhzl'
        },
        {
          title: '宽带',
          active: false,
          href: '/unicomwisdomeyes/broadband?pagesource=yhzl'
        },
        {
          title: '承载',
          active: true,
          href: '/unicomwisdomeyes/network_loadbear?pagesource=yhzl'
        },
        {
          title: 'IDC',
          active: false,
          href: '/unicomwisdomeyes/cloud_idc?pagesource=yhzl'
        }
      ],
      iframeSrc: '',
      iframeSrc2: '',
      gisQueryParams: {},
      queryParams: {},
      gisMapData: {},
      mapLevel: 1,
      areaCode: '',
      cityCode: '370000',
      netKjzyData: {},
      netXlData: {},
      netZylData: {},
      qwJxwlData: {},
      dialogShow1: false,
      dialogShow2: false,
      dialogShow3: false,
      dialogShow4: false,
      dialogShow5: false,
      dialogShow6: false,
      dialogShow7: false,
      dialogShow8: false,
      dialogShow9: false,
      dialogShow10: false,
      wx_tabledata: [],
      cs_tabledata: [],
      xl_tabledata: [],
      jrw_tabledata: [],
      kjzy_tabledata: [],
      czy_tabledata: [],
      jxwl1_tabledata: [],
      jxwl2_tabledata: [],
      sj_tabledata: [],
      control: [],
      pmdatalist: [],
      xlloading: false,
      oldcsDataList: {},
      cs_tabledata2: [],
      gzxlData: {},
      sbdata: {},
      kdlylData: [],
      kdlylIshow: false,
      zhy_content: '',
      tabstatus: '0201',
      activeIndex: '1',
      or_he: '1'
    }
  },
  components: {
    comheader,
    Footer
  },
  created() {
    if (this.$route.query.pagesource && this.$route.query.pagesource == 'yhzl') {
      this.or_he = '0'
    } else {
      this.or_he = '1'
    }
  },
  mounted() {
    var self = this
    var initArea_id = '370000'
    this.mapLevel = 1
    if (store.get('userInfo')) {
      var userInfo = store.get('userInfo')
      var mapLevel = userInfo.levelAreaLevel
      // 分权分域
      if (mapLevel == '1') {
        // 全省
        initArea_id = '370000'
        self.gisTitle = '山东省'
        self.mapLevel = '1'
        self.control = ['370000']
      } else if (mapLevel == '2') {
        // 地市
        initArea_id = '370000'
        self.gisTitle = '山东省'
        self.mapLevel = '1'
        self.control = ['370000', userInfo.levelAreaCode]
      } else if (mapLevel >= '3') {
        // 区县
        initArea_id = userInfo.levelAreaCode
        self.mapLevel = '2'
        self.gisTitle = userInfo.levelAreaName
        self.control = ['370000', userInfo.levelAreaCode, userInfo.levelCityCode]
      }
    }
    this.cityCode = initArea_id

    this.initGisMap(initArea_id)

    // 注册地图事件
    window.addEventListener('message', self.gismapListener, true)
    this.initService()
  },
  watch: {
    rt1status(val) {
      this.$nextTick(() => {
        if (val == 2) {
          echartResie1 && echartResie1.$resize()
        }
      })
    }
  },
  computed: {
    ...mapState({
      searchDate: state => state.resource.searchDate
    })
  },
  methods: {
    initService() {
      // 写死
      if (this.mapLevel > 2) {
        return
      }
      this.serviceQwGztj() //  guzhang
      //   this.serviceNetWx()
      this.serviceNetXl() //  xianlu
      //   this.serviceQwSj()
      // this.serviceNetCs()
      this.serviceQwWlnl()
      // this.serviceQwJrw()
      this.serviceNetKjzy()
      this.serviceQwZyl()
      // this.serviceQwWycb()
      this.serviceQwXlbc()
      this.serviceQwKh()
      this.serviceQwDlwzx()
      this.serviceWczSb()

      this.serviceWczKdlyl()
    },
    tabStatusFn_new(type) {
      // 先写死
      this.tabstatus_new = type
      if (type == 2) {
        this.initGisMap2()
      }
    },

    dropdownSelect1(imgtype, type) {
      this.tabstatus_new = 3
      this.tpimgsrc = require(`./tuopu/tp${imgtype}.png`)
    },
    dropdownSelect2(imgtype, type) {
      this.tabstatus_new = 4
      this.tpimgsrc = require(`./tuopu/tp${imgtype}.png`)
    },

    tabStatusFn(type) {
      let that = this
      this.tabstatus = type
      if (type == '0202') {
        that.conttuopuimgobj.conttuopuimg = that.conttuopuimgobj.conttuopuimg1
      }
    },
    tabStatusFn1(key, keyPath) {
      //console.log(key, keyPath);
      this.tabstatus = '0202'
      let that = this
      if (key == '1-1') {
        that.conttuopuimgobj.conttuopuimg = that.conttuopuimgobj.conttuopuimg1
      } else if (key == '1-2') {
        that.conttuopuimgobj.conttuopuimg = that.conttuopuimgobj.conttuopuimg2
      } else {
        that.conttuopuimgobj.conttuopuimg = that.conttuopuimgobj.conttuopuimg1
      }
    },
    serviceWczSb() {
      // 写死
      var params = {
        or_he: this.or_he,
        cityCode: '370000' || this.cityCode
      }
      serviceApi.serviceWczSb(params).then(res => {
        if (res.rspCode == '0000') {
          this.sbdata = res.result.data[0] || {}
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    csDetailFn() {
      this.dialogShow1 = true
      this.serviceQwWlnlXq()
    },
    formatVal(val) {
      if (val || val == 0) {
        return val
      } else {
        return '-'
      }
    },

    serviceWczKdlyl() {
      // 写死
      var params = {
        cityCode: '370000' || this.cityCode,
        or_he: this.or_he
      }
      serviceApi.serviceWczKdlyl(params).then(res => {
        this.zydeshow = false
        if (res.rspCode == '0000') {
          var datal = res.result.data
          let charts = {
            domId: 'chart_line12',
            zoomVal: 100,
            unit: '百分比',
            names: ['流入最大带宽利用率', '流出最大带宽利用率'],
            lineX: datal.map(item => {
              return item.name
            }),
            bar_markLine: [],
            value: [
              datal.map(item => {
                return parseFloat(item.rate_maxin) || 0
              }),

              datal.map(item => {
                return parseFloat(item.rate_maxout) || 0
              })
            ]
          }
          echarts_init.initechart_lines(charts)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    serviceQwWlnlXq() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      this.zydeshow = true
      serviceApi.serviceQwWlnlXq(params).then(res => {
        this.zydeshow = false
        if (res.rspCode == '0000') {
          var datal = res.result.data
          this.cs_tabledata2 = this.initSortTabledata(datal)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    xldetailFn() {
      this.dialogShow2 = true
      this.serviceQwXlxq()
    },
    zydetailFn() {
      this.dialogShow6 = true
      this.serviceQwZyxq()
    },
    serviceQwZyxq() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      this.zydeshow = true
      this.czy_tabledata = []
      serviceApi.serviceQwZyxq(params).then(res => {
        this.zydeshow = false
        if (res.rspCode == '0000') {
          this.czy_tabledata = this.initSortTabledata(res.result.data)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    serviceQwXlxq() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      this.xlloading = true
      this.xl_tabledata = []
      serviceApi.serviceQwXlxq(params).then(res => {
        if (res.rspCode == '0000') {
          this.xlloading = false
          this.xl_tabledata = this.initSortTabledata(res.result.data)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    fiterPardata(datas, citycode) {
      var datal = datas.filter(item => {
        return item.code == citycode
      })
      return datal.length > 0 ? datal[0] : {}
    },
    //故障
    serviceQwGztj() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }

      serviceApi.serviceQwGztj(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = res.result.data[0]
          //  var params1 = {
          //   domId: 'rcharbox1',
          //   name:'一 干',
          //   value: datal.one_fault_num || 0
          // }
          // echartInit.initChartgauge(params1)
          // var params2 = {
          //   domId: 'rcharbox2',
          //   name:'二干',
          //   value: datal.two_fault_num || 0
          // }
          // echartInit.initChartgauge(params2)
          // var params1 = {
          //   domId: 'rcharbox3',
          //   name:'本地',
          //   value:datal.local_fault_num || 0
          // }
          // echartInit.initChartgauge(params1)
          this.gzxlData = datal
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 匠心网络
    serviceQwJxwl() {
      var params = {
        cityCode: this.cityCode
      }
      this.qwJxwlData = {}
      serviceApi.serviceQwJxwl(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = this.fiterPardata(res.result.data, this.cityCode)
          var datasN = this.initSortTabledata(res.result.data)
          datasN.forEach(item => {
            item.reach_standard_sort = parseFloat(item.reach_standard) || 0
            item.reach_standard_num_sort = parseFloat(item.reach_standard_num) || 0
          })
          this.jxwl1_tabledata = datasN
          this.qwJxwlData = datal
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    parseNum(data) {
      var item = _.cloneDeep(data)
      Object.keys(item).forEach(key => {
        Number(item[key]) || Number(item[key]) === 0 ? (item[key] = Number(item[key]).toFixed(0)) : item[key]
      })

      return item
    },
    // 线路
    serviceNetXl() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      this.netXlData = {}
      serviceApi.serviceQwDpxl(params).then(res => {
        if (res.rspCode == '0000') {
          // //debugger
          // var datal = this.fiterPardata(res.result.data, this.cityCode)
          // this.xl_tabledata = this.initSortTabledata(res.result.data)
          this.netXlData = this.parseNum(res.result.data[0] || {})
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 数据
    serviceQwSj() {
      var params = {
        cityCode: this.cityCode
      }
      serviceApi.serviceNetSj(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = this.fiterPardata(res.result.data, this.cityCode)
          this.sj_tabledata = this.initSortTabledata(res.result.data)

          this.qwsjData = datal || {}

          var waterchart1 = {
            id: 'watercahrt1',
            value: datal.bras_pool_rate || 0
          }
          waterPoloChart.initChart(waterchart1)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },

    // 传输
    serviceNetCs() {
      var params = {
        cityCode: this.cityCode
      }
      serviceApi.serviceNetCs(params).then(res => {
        if (res.rspCode == '0000') {
          // var datal = this.fiterPardata(res.result.data, this.cityCode);
          this.oldcsDataList = res.result.data || []
          this.cs_tabledata = this.initSortTabledata(res.result.data)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    serviceQwWlnl() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      serviceApi.serviceQwWlnl(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = res.result.data[0] || {}
          var chartparams3 = {
            domId: 'chart_cspie',
            name: '传输',
            unit: '',
            datal: [
              {
                value: datal.ipran_enum || 0,
                name: 'IPRAN',
                dknum: datal.ipran_num || 0,
                ratenum: datal.ipran_rate || 0
              },
              { value: datal.sdh_enum || 0, name: 'SDH', dknum: datal.shd_num || 0, ratenum: datal.shd_rate || 0 },
              { value: datal.otn_enum || 0, name: 'OTN', dknum: datal.otn_num || 0, ratenum: datal.otn_rate || 0 }
            ],
            data: [
              { value: datal.sb_ipran_num || 0, name: 'IPRAN' },
              { value: datal.sb_sdh_num || 0, name: 'SDH' },
              { value: datal.sb_otn_num || 0, name: 'OTN' }
            ]
          }
          echartInit.initEchart_pie4(chartparams3)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    initSortTabledata(datas) {
      var datal = _.cloneDeep(datas)
      datal.forEach(item => {
        Object.keys(item).forEach(key => {
          Number(item[key]) || Number(item[key]) === 0 ? (item[key] = Number(item[key])) : item[key]
        })
      })

      return datal
    },
    // 接入网
    serviceQwJrw() {
      var params = {
        cityCode: this.cityCode
      }
      serviceApi.serviceNetJrw(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = this.fiterPardata(res.result.data, this.cityCode)
          this.jrw_tabledata = this.initSortTabledata(res.result.data)
          var chartparams4 = {
            domId: 'chart_jrwbar',
            xData: ['一级分光器', '一级分光器端口', '二级分光器', '二级分光器端口', 'IPTV用户', '宽带用户', 'OLT设备'],
            uni: '',
            barData: [
              datal.one_splitter || 0,
              datal.one_splitter_port || 0,
              datal.two_splitter || 0,
              datal.two_splitter_port || 0,
              datal.iptv_user_num || 0,
              datal.broadband_user_num || 0,
              datal.olt_num || 0
            ]
          }
          echartResie1 = new echartInit.initEchart_barLine(chartparams4)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 无线
    serviceNetWx() {
      var params = {
        cityCode: this.cityCode
      }
      serviceApi.serviceNetWx(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = this.fiterPardata(res.result.data, this.cityCode)
          this.wx_tabledata = this.initSortTabledata(res.result.data)

          var chartparams2 = {
            domId: 'chart_wxpie',
            name: '无线',
            unit: '万',
            data: [
              { value: datal.user_3g || 0, name: '3G用户数' },
              { value: datal.user_4g || 0, name: '4G用户数' },
              { value: datal.user_5g || 0, name: '5G用户数' }
            ]
          }
          echartInit.initEchart_pie(chartparams2)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 空间资源
    serviceNetKjzy() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      this.netKjzyData = {}
      serviceApi.serviceNetKjzy(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = this.fiterPardata(res.result.data, this.cityCode)
          this.kjzy_tabledata = this.initSortTabledata(res.result.data)
          this.netKjzyData = datal
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 资源量
    serviceQwZyl() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      this.netZylData = {}
      serviceApi.serviceQwDpzy(params).then(res => {
        if (res.rspCode == '0000') {
          this.netZylData = res.result.data[0] || {}
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 网运成本占收比
    serviceQwDlwzx() {
      // 写死
      var params = {
        or_he: this.or_he,
        cityCode: '370000' || this.cityCode
      }
      serviceApi.serviceQwDlwzx(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = res.result.data || []
          datal.forEach(item => {
            item.value = parseFloat(item.dianlu_com) || 0
          })

          datal = _.orderBy(
            datal,
            function(item) {
              return Number(item['value']) || 0
            },
            ['desc']
          )

          var chartparams1 = {
            domId: 'chart_wycb',
            zoomVal: 100,
            xData: datal.map(item => {
              return item.name
            }),
            uni: '%',
            barData: datal.map(item => {
              return item.value
            })
          }
          echartInit.initEchart_barLine(chartparams1)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 线路补偿
    serviceQwXlbc() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      serviceApi.serviceQwXlbc(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = res.result.data || []
          datal = _.orderBy(
            datal,
            function(item) {
              return Number(item['leiji_enter']) || 0
            },
            ['desc']
          )

          var chartparams1 = {
            domId: 'chart_rightxlpb',
            zoomVal: 100,
            xData: datal.map(item => {
              return item.name
            }),
            uni: '',
            barData: datal.map(item => {
              return item.leiji_enter
            })
          }
          echartInit.initEchart_barLine(chartparams1)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    // 考核
    serviceQwKh() {
      var params = {
        or_he: this.or_he,
        cityCode: this.cityCode
      }
      serviceApi.serviceQwKh(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = res.result.data
          datal = _.orderBy(
            datal,
            function(item) {
              return Number(item['array']) || 0
            },
            ['asc']
          )
          this.pmdatalist = datal.slice(0, 3)
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    getEyesInfo() {
      //智慧眼
      this.zhyDshow = true
      this.getEyesConten()
    },
    getEyesConten() {
      if (this.mapLevel > 1) {
        return
      }
      var params = {
        code: 'wang-cz',
        area_code: '370000'
      }
      serviceApis.servicejkdTc(params).then(res => {
        if (res.rspCode == '0000') {
          var datal = res.result.data[0] || {}
          this.zhy_content = datal.zhy_content
        } else {
          this.$message.error(res.rspMsg)
        }
      })
    },
    gismapListener(e) {
      var self = this
      if (e.data.message == 'levelSwitch') {
        self.gisTitle = e.data.area_name || '山东省'
        self.mapLevel = e.data.level
        self.areaCode = e.data.area_id
        self.gisMapData = e.data
        self.gisQueryParams = Object.assign({}, self.gisQueryParams, e.data)
        self.gisQueryParams.area_name = ''
        self.cityCode = e.data.area_id
        self.initService()
        console.log('message', e.data)
      } else if (e.data.message == 'changeCity') {
        self.gisTitle = e.data.area_name || '山东省'
        self.mapLevel = e.data.level
        self.areaCode = e.data.area_id
        self.gisMapData = e.data
        self.gisQueryParams = Object.assign({}, self.gisQueryParams, e.data)
        self.gisQueryParams.area_name = ''
        self.cityCode = e.data.area_id
        self.initService()
      }
    },
    initGisMap(initArea_id) {
      // 初始化地图参数
      this.gisQueryParams = {
        yanhuang: this.or_he,
        control: this.control.join(','),
        level: this.mapLevel,
        sceneid: '6',
        gis_sceneid: '',
        area_id: initArea_id,
        poi_city_id: '',
        system_type: 'C40',
        login_no: store.get('staffId') || '',
        timest: this.$store.state.resource.searchDate
      }
      var gisQueryParams = JSON.parse(JSON.stringify(this.gisQueryParams))
      this.iframeSrc = window.gis_iframeSrc + `/smartEyes?${Qs.stringify(gisQueryParams)}`
    },

    initGisMap2() {
      // 初始化地图参数
      this.gisQueryParams = {
        control: [],
        level: 1,
        sceneid: '1',
        gis_sceneid: '',
        area_id: '37000',
        poi_city_id: '',
        system_type: 'C40',
        login_no: store.get('staffId') || '',
        timest: this.$store.state.resource.searchDate
      }
      var gisQueryParams = JSON.parse(JSON.stringify(this.gisQueryParams))
      this.iframeSrc2 = window.gis_iframeSrc + `/smartEyes?${Qs.stringify(gisQueryParams)}`
    },
    formatNumber(num) {
      if (Number(num)) {
        return Number(num).toLocaleString()
      } else {
        return ''
      }
    }
  },
  destroyed() {
    // 在组件生命周期结束的时候销毁。
    window.removeEventListener('message', this.gismapListener, true)
  }
}
</script>

<style lang="scss" scoped>
@import url('../comtable.scss');
.topboxchart {
  height: 360px;
  position: relative;
}
/deep/ .bottom-tab {
  width: 80%;
  align-items: center;
  padding-top: 0px;
  bottom: 10px;
}

/deep/ .bottom-tab .bottom-item {
  padding: 4px 30px;
}
.bottom-tab .bottom-item .crbox {
  text-align: center;
}
.flex1 {
  flex: 1;
}
.flex {
  display: flex;
}
.colflex {
  flex-direction: column;
}
.contentbody {
  flex: 1;
  display: flex;
  padding: 15px;
  box-sizing: border-box;
  background: url('~@/assets/images/bigScreen/bg-left.png') left no-repeat,
    url('~@/assets/images/bigScreen/bg-right.png') right no-repeat;
  background-size: auto 100%;
  margin: -30px 10px 10px 10px;
  position: relative;
}
.left-content,
.right-content {
  width: 500px;
  display: flex;
  flex-direction: column;
}
.center-content {
  flex: 1;
  padding: 0 15px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
}

.flexitem-box {
  margin-bottom: 10px;
  box-sizing: border-box;
}

//  .item-title {
//    font-size: 22px;
//    color: aqua;
//    background: url('~@/assets/images/images_zy/itemtitle.png') no-repeat ;
//    background-size: 100% 100%;
//    line-height: 34px;
//     padding-left: 50px;
//     margin-bottom: 5px;
//  }

.item-title {
  font-size: 18px;
  color: aqua;
  background: url('~@/assets/images/bigScreen/titlebg.png') no-repeat;
  background-size: 100% 100%;
  line-height: 44px;
  padding-left: 36px;
  margin-bottom: 5px;
  font-weight: bolder;
}
.left-content .flexitem-box:last-child,
.right-content .flexitem-box:last-child {
  margin-bottom: 0px;
}
.ctop-box {
  margin-bottom: 0px;
  margin-top: 17px;
}
.cbottom-box {
  flex: 1;
  box-sizing: border-box;
  background: url('~@/assets/images/images_zy/中框线@2x.png') no-repeat;
  background-size: 100% 100%;
  margin-top: 10px;
  margin-bottom: 70px;
  box-sizing: border-box;
  position: relative;
  padding: 20px 20px 20px 20px;
  position: relative;
  padding-top: 100px;
  .gxinfoca {
    position: absolute;
    bottom: 10px;
    right: 15px;
    padding: 10px 15px;
    background: transparent;
    border-radius: 5px;
    background: rgba(0, 0, 0, 0.1);
    box-shadow: 0 0 10px rgb(13, 65, 133);

    .gxtitle {
      font-size: 16px;
      text-align: center;
      border-bottom: 1px solid rgb(28, 104, 167);
      line-height: 32px;
      margin-bottom: 6px;
    }
    .gxrow {
      line-height: 28px;
    }
  }
}
.text-center {
  text-align: center;
}
.wxitem {
  font-size: 16px;
  text-align: center;
  .wxitem-tt {
    color: #ffcc00;
    line-height: 38px;
    font-weight: bold;
  }
  img {
    width: 40px;
    margin-bottom: 10px;
  }
}
.itemstitle {
  height: 36px;
  line-height: 36px;
  display: flex;
  text-align: center;
}

.chartbox {
  width: 100%;
  height: 100%;
  box-sizing: border-box;
}

.crilbox {
  text-align: center;
  // padding-top: 30px;
}
/deep/ .el-progress__text {
  color: #fff;
  font-size: 14px !important;
}
.cirfont {
  font-size: 16px;
  color: #00ccff;
}

/deep/ .mkciritem .el-progress__text {
  font-size: 11px !important;
  width: 60px;
  margin: 0 auto;
  margin-left: 16px;
  line-height: 16px;
}
#barchar_wx {
  position: relative;
}
#barchar_wx::after {
  content: '';
  display: block;
  background: url('~@/assets/images/bigScreen/resource/split.png') no-repeat;
  background-size: 100% 100%;
  height: 80%;
  width: 1px;
  margin-left: 10px;
  position: absolute;
  right: -5px;
  top: 20px;
}
.borderafter {
  position: relative;
  padding: 0 30px;
  box-sizing: border-box;
}
.borderafter::after {
  content: '';
  display: block;
  background: url('~@/assets/images/bigScreen/resource/split.png') no-repeat;
  background-size: 100% 100%;
  height: 80%;
  width: 1px;
  margin-left: 10px;
  position: absolute;
  right: 0px;
  top: 20px;
}

.borderafter::before {
  content: '';
  display: block;
  background: url('~@/assets/images/bigScreen/resource/split.png') no-repeat;
  background-size: 100% 100%;
  height: 80%;
  width: 1px;
  margin-left: 10px;
  position: absolute;
  left: -10px;
  top: 20px;
}
.cblue {
  color: #00ccff;
}
.bgitem {
  padding: 6px 10px;
  background: #22a4aa6b;
  border-radius: 5px;
}
.bbitembox {
  text-align: center;
}
.bbitembox .flex1 {
  position: relative;
  .imgbox {
    margin-top: -5px;
  }
}

.bfontbox {
  .numfont {
    font-size: 16px;
    color: #ffcc00;
  }
  .bfont {
    color: #00ccff;
  }
}
/deep/ .border-box-content {
  display: flex;
  padding: 10px;
}

.centtopbox_k {
  height: 66px;
  background: url('~@/assets/images/images_zy/img2/bg@2x.png') no-repeat;
  background-size: 100% 100%;
  text-align: center;
  display: flex;
  padding: 5px;
  box-sizing: border-box;
  .numfont {
    color: #ffcc00;
    font-size: 20px;
    line-height: 30px;
    height: 30px;
  }
  .cirfont {
    line-height: 20px;
  }
}
.centbotbox_k {
  text-align: center;
  .scrollrow {
    color: #00ccff;
    line-height: 28px;
    border-bottom: 1px dashed #152f5f;
    font-size: 14px;
    .flex1 {
      padding: 0 5px;
    }
  }
}

.tropbox {
  text-align: center;
  .numfont2 {
    color: #ffcc00;
    font-size: 22px;
    line-height: 40px;
    height: 40px;
    margin-top: 10px;
    .unit {
      color: #fff;
      font-size: 16px;
    }
  }
  .titlefont2 {
    font-size: 16px;
    font-weight: bolder;
  }
}

.tooltipbox {
  position: absolute;
  width: 100%;
  background: rgba(0, 0, 0, 0.6);
  bottom: 0;
  line-height: 24px;
  font-size: 13px;
  z-index: 99;
  transition: all 0.3s linear;
  overflow: hidden;
  height: 0px;
  box-sizing: border-box;
}

.xlitem {
  margin: 10px 10px 0 10px;
  background: url('~@/assets/images/images_zy/img2/bg@2x.png') no-repeat;
  background-size: 100% 100%;
  line-height: 44px;
  padding: 5px;
  text-align: left;
  height: 50px;
  font-size: 16px;
  .leftttt {
    display: inline-block;
    width: 80px;
    text-align: right;
    margin-right: 4px;
  }
  .nunfont {
    font-size: 18px;
    color: #ffcc00;
  }
}
.tunit {
  font-size: 16px;
  margin-left: 2px;
}

.gistitle {
  position: absolute;
  left: 20px;
  top: 20px;
  font-size: 24px;
  color: aqua;
}

.ggitembox {
  height: 100%;
  width: 50%;
  box-sizing: border-box;
  float: left;
  position: relative;
  // box-shadow: 0 2px 6px rgb(6, 102, 158);
  padding: 12px 0;
}
.xlbodyrow1 {
  border-right: 1px solid rgb(1, 48, 86);
}
.boxshadowitem {
  position: relative;
  // box-shadow: 0 2px 6px rgb(6, 102, 158);
}

.subtitlegg {
  width: 140px;
  height: 28px;
  line-height: 28px;
  background: linear-gradient(to right, #00113163, #078db4, #00113163);
  font-size: 16px;
  font-weight: bolder;
  text-align: center;
}
.flexrow1 {
  align-items: center;
  text-align: center;
  .itemttil {
    font-size: 18px;
    color: aqua;
    line-height: 36px;
    .unit {
      font-size: 16px;
    }
  }
  .numfont {
    font-size: 20px;
    color: #ffcc00;
  }
}
.waterCharbox {
  height: 100px;
}
.waterCharbox2 {
  line-height: 30px;
  font-size: 18px;
  padding-top: 22px;
  box-sizing: border-box;
  text-align: left;
}
.lineinfo {
  display: inline-block;
  width: 80px;
  text-align: right;
}
.charrow {
  text-align: center;
  .waterinfo {
    font-size: 16px;
    line-height: 36px;
    margin-bottom: 5px;
    color: #f5f5f5;
  }
}
.kjzybox {
  align-items: center;
  text-align: center;
  .numfont {
    font-size: 24px;
    color: rgb(247, 205, 19);
    margin-bottom: 10px;
  }
  .unit {
    font-size: 16px;
  }
  img {
    width: 40px;
  }
  .kjzyinfo {
    font-size: 20px;
    line-height: 60px;
  }
}

.jxwlrow {
  text-align: center;
  align-items: center;
  .numfont {
    color: #ffcc00;
    font-size: 20px;
    margin-right: 4px;
  }
  img {
    width: 44px;
    margin: 6px 0 10px 0;
  }
  .jxinfo {
    line-height: 38px;
    font-size: 16px;
  }
}

.jxwlrow2 {
  .jxinfo {
    font-size: 16px;
  }
}
.tcinfoitem {
  text-align: center;
  padding: 5px 0;
  background: linear-gradient(to right, #00113163, #047dad, #00113163);
  .tinfo {
    font-size: 18px;
    color: #fff;

    .unit {
      font-weight: normal;
      font-size: 14px;
    }
  }
  .numfont {
    font-size: 22px;
    color: #ffcc00;
  }
}

.rowttabs {
  height: 40px;
  line-height: 40px;
  font-size: 16px;
  margin-left: 5px;
  margin-top: 4px;
  font-family: Arial, Helvetica, sans-serif;
  .rowttabs-item {
    padding: 3px 15px;
    border-radius: 4px;
    border: 1px solid #5b7bc9;
    margin-right: 10px;
    color: #698bdf;
    cursor: pointer;
  }

  .rowttabs-item.active {
    border: 1px solid #45d8e2;
    color: #45d8e2;
  }
}
.rowinfo {
  line-height: 32px;
  font-size: 16px;
  padding-left: 15px;
}
.zdmore {
  float: right;
  font-size: 16px;
  cursor: pointer;
  color: #57b4f1;
  margin-right: 0px;
  text-decoration: underline;
  position: absolute;
  z-index: 999;
  right: 0;
  top: -2px;
}

/deep/ .el-dialog {
  -webkit-transform: none;
  transform: none;
  left: 0;
  position: relative;
  z-index: 20000;
  margin: 0 auto;
  padding-bottom: 30px;
  background-image: url('~@/assets/images/bigScreen/kuang.png');
  background-size: 100% 100%;
  background-color: rgba(220, 38, 38, 0);
}

/deep/ .el-dialog__body {
  padding: 0px 20px;
}
/deep/ .el-dialog__headerbtn .el-dialog__close {
  color: #fff;
  font-size: 24px;
  font-weight: 500;
  margin: 2px 20px 0 0;
  border: 2px solid #193987;
  border-radius: 5px;
  background: #1e1e88;
}
.dialogCon {
  padding: 0 40px;
  .dialogTitle {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-right: 30px;
    .left {
      display: inline-block;
      padding-right: 110px;
      font-size: 24px;
      font-family: MFBanHei;
      font-weight: 400;
      color: #02f6ff;
      background-image: url('~@/assets/images/bigScreen/fullService/Rectangle 561.png');
      background-repeat: no-repeat;
      background-position: center right;
    }
    .title-right {
      color: #218cc8;
      font-size: 12px;
      font-family: Microsoft YaHei;
      div {
        width: 38px;
        height: 30px;
        line-height: 30px;
        text-align: center;
        display: inline-block;
        cursor: pointer;
        background-image: url('~@/assets/images/bigScreen/fullService/left-sub.png');
        background-repeat: no-repeat;
        background-size: 100% 100%;
      }
      .active {
        color: #02f6ff;
        background-image: url('~@/assets/images/bigScreen/fullService/left-subActive.png');
      }
    }
  }
}
/deep/ .el-table {
  background: none !important;
  font-size: 15px !important;
}
/deep/.dialogTableBg .el-table th {
  background: none !important;
  background: url('~@/assets/images/bigScreen/fullService/597bcdc505fa3.png') no-repeat !important;
  background-position: center 11px !important;
  background-size: contain !important;
  text-align: center !important;
  color: #02f6ff !important;
  font-size: 15px !important;
}

/deep/ .el-table tr {
  background: none !important;
}

/deep/.el-table td {
  background: none !important;
  border: none !important;
  text-align: center !important;
  color: #ffffff;
}
/deep/ .inittable2.el-table td {
  padding: 6px 0;
}
/deep/.el-table td.is-left {
  text-align: left !important;
}

/deep/.el-table td:first-child {
  background: none !important;
}

/deep/ .el-table th.is-leaf,
.el-table td {
  border: none !important;
  color: #ffffff;
}
/deep/.el-table::before {
  height: 0 !important;
}
/deep/.el-table th > .cell {
  display: contents !important;
}
/deep/.el-table .cell {
  padding: 0 6px;
}
/deep/ .dialogTableBg .el-table tr:nth-child(even) {
  background: rgba(4, 54, 108, 0.4) !important;
}
.tbtitle {
  line-height: 30px;
  color: #b5d6ed;
  font-size: 20px;
  padding-left: 20px;
  border-bottom: 1px solid #174b80;
  border-left: 4px solid #228ae3;
  margin: 10px 0;
  font-weight: bold;
}

/deep/ .el-loading-mask {
  background-color: rgba(6, 26, 58, 0.7);
}
/deep/ .grouptable.el-table tbody td {
  border-right: 1px dashed rgb(45, 61, 94) !important;
}
/deep/.groupheadtable.custom_table thead th:not(:last-child) {
  border-right: 1px solid rgb(45, 61, 94) !important;
}
/deep/.el-table__fixed {
  background: #00133e !important;
}

/deep/.el-table__fixed::before,
/deep/ .el-table__fixed-right::before {
  background: transparent !important;
}
/deep/ .el-table th.is-leaf {
  font-size: 16px !important;
}
/deep/ .dialogTableBg .custom_table.el-table tbody tr td {
  font-size: 15px !important;
  padding: 6px 0 !important;
}

@keyframes turn {
  0% {
    -webkit-transform: rotate(0deg);
  }
  25% {
    -webkit-transform: rotate(90deg);
  }
  50% {
    -webkit-transform: rotate(180deg);
  }
  75% {
    -webkit-transform: rotate(270deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
  }
}
.tjbtn {
  position: absolute;
  right: 36px;
  top: 30px;
  border-radius: 50%;
  padding: 4px;
  box-shadow: 0 0 10px rgb(56, 148, 235);
  cursor: pointer;
  animation: turn 8s linear infinite;
  z-index: 99;
  img {
    width: 44px;
    z-index: 99;
  }
}
.tjtitle {
  color: #fff;
  font-size: 18px;
  font-weight: bolder;
  letter-spacing: 1px;
  background: linear-gradient(45deg, #1a92d4, transparent);
  line-height: 34px;
  padding-left: 15px;
  border-radius: 20px 0 0 20px;
  width: 60%;
}
.tjitem {
  // padding: 10px;
  color: #fff;
  font-size: 20px;
  p {
    line-height: 48px;
    margin-bottom: 0;
  }
}
.subtitlegg2 {
  span {
    padding: 5px 15px;
    border: 1px solid #047dad;
    border-radius: 6px;
    margin: 10px;
    color: #7bcdee;
  }
}

/deep/ .el-loading-mask {
  background-color: rgba(6, 26, 58, 0.7);
}
/deep/ .grouptable.el-table tbody td {
  border-right: 1px dashed rgb(45, 61, 94) !important;
}
/deep/.groupheadtable.custom_table thead th:not(:last-child) {
  border-right: 1px solid rgb(45, 61, 94) !important;
}
/deep/.el-table__fixed {
  background: #00133e !important;
}

/deep/.el-table__fixed::before,
/deep/ .el-table__fixed-right::before {
  background: transparent !important;
}
/deep/ .el-table th.is-leaf {
  font-size: 15px !important;
}

.matbox {
  margin-top: 10px;
  .matfont {
    font-size: 24px;
    color: #eebf24;
    font-weight: bold;
    line-height: 46px;
  }
  .matimg {
    img {
      width: 40px;
    }
  }
}
.mattitle {
  font-size: 18px;
  margin-top: 10px;
  font-weight: bolder;
}
.matitembox {
  text-align: center;
  padding-top: 20px;
}
.centTab {
  position: absolute;
  z-index: 10;
  width: 40%;
  top: 0px;
  left: 30%;
  text-align: center;
  .centtabitem {
    position: relative;
    display: inline-block;
    height: 56px;
    width: 140px;
    line-height: 66px;
    text-align: center;
    font-size: 18px;
    cursor: pointer;
    color: rgb(2, 252, 252);
    background: url('~@/assets/images/images_zy/WechatIMG431.png') no-repeat;
    background-size: 100% 120%;
    margin-right: -15px;
    opacity: 0.5;
  }
  .centtabitem.active {
    opacity: 1;
  }
}

.centTab2 {
  position: absolute;
  z-index: 10;
  width: 100%;
  top: 20px;
  left: 0;
  text-align: center;
  .centtabitem {
    position: relative;
    display: inline-block;
    height: 56px;
    width: 150px;
    line-height: 66px;
    text-align: center;
    font-size: 18px;
    cursor: pointer;
    color: rgb(2, 252, 252);
    background: url('~@/assets/images/images_zy/WechatIMG431.png') no-repeat;
    background-size: 100% 120%;
    margin-right: -15px;
    opacity: 0.5;
  }
  .centtabitem.active {
    opacity: 1;
  }
}

.zelmenu {
  top: 14px;
  right: 17px;
  border: none;
  .el-submenu {
    width: 100%;
  }
  .el-submenu__title {
    height: 40px;
    line-height: 40px;
    border: none;
  }
}
.conttuopu {
  position: relative;
  overflow: hidden;
  width: 100%;
  height: 600px;
  margin-top: 5%;
  box-sizing: border-box;
  img {
    display: inline-block;
    width: 100%;
    height: 100%;
  }
}

.conttuopu2 {
  position: relative;
  overflow: hidden;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  img {
    display: inline-block;
    width: 100%;
    height: 100%;
  }
}
.el-menu--horizontal {
  .el-menu--popup {
    background-color: rgba(0, 8, 71, 1) !important;
  }
}
</style>
<style lang="scss">
.zelmenu {
  .el-submenu {
    .el-submenu__title {
      height: 40px;
      line-height: 40px;
      border: none;
    }
    .el-icon-arrow-down:before {
      content: ' ';
    }
  }
}
.el-menu--horizontal {
  .el-menu--popup {
    background-color: rgba(0, 8, 71, 1) !important;
  }
}
.initdropdown .el-dropdown-link {
  color: #fff;
  font-size: 18px;
  cursor: pointer;
}
.initdropdownmenu {
  width: auto;
  text-align: center;
  background: #020738b8;
  border-color: #5bcbe2;
}
.initdropdownmenu .el-dropdown-menu__item {
  color: #fff;
  font-size: 16px;
}
.initdropdownmenu .el-dropdown-menu__item {
  border-bottom: 1px dashed rgb(23, 81, 189);
}
.initdropdownmenu .el-dropdown-menu__item:last-child {
  border: none !important;
}
.initdropdownmenu .el-dropdown-menu__item:hover {
  color: #00ffff;
  background: #020738b8;
}
</style>
