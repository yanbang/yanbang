<template>
  <div class="container">
    <!-- 页头 -->
    <Header>
      <template v-slot:smallTitle>
        <div class="header-smallTitle">渠道</div>
      </template>
    </Header>
    <!-- 内容 -->
    <FlexBox :list="bottomList" style="margin-top: -10px">
      <template slot>
        <!-- 左边 -->
        <div class="left">
          <charts id="test1" title="5G发展" :form="fiveGData" @click.native="clickMode('1')" :class="[selectMode === '1' ? 'backgroundImage3' : 'backgroundImage2']" style="height: 230px" @moreFn="openfiveGDialogShow">
          </charts>
          <div style="margin-top: 10px" @click="clickMode('2')" :class="[selectMode === '2' ? 'backgroundImage4' : 'backgroundImage']" class="backgroundImage">
            <div style="margin-left: 20px">
              <div style="display: block; height: 10px"></div>
              <span class="chartTitle">双融发展</span>
              <img src="../../assets/images/bigScreen/fullService/Rectangle@2x.png" style="height: 14px; width: 60px; margin-left: 10px" />
              <div class="borderLine"></div>
              <!--              <span  style="float: right;margin-right: 30px">更多></span>-->
            </div>
            <charts-right title="移宽融合" :form="togetherData" style="height: 198px"></charts-right>
            <div class="borderLine"></div>
            <charts-right title="移移融合" :form="mainAndNotMainData" style="height: 198px"></charts-right>
            <div class="borderLine"></div>
            <charts-right title="金融融合" :form="financeData" style="height: 210px"></charts-right>
          </div>
        </div>
        <!-- 中间 -->
        <div class="center">
          <!-- <div class="centerTop"></div> -->
          <el-row :gutter="20" style="height: 228px">
            <el-col :span="12">
              <charts id="test2" @click.native="clickMode('5')" :class="[selectMode === '5' ? 'backgroundImage3' : 'backgroundImage2']" :form="mobileData" title="移网发展" style="height: 228px"></charts>
            </el-col>
            <el-col :span="12">
              <charts id="test3" @click.native="clickMode('6')" :class="[selectMode === '6' ? 'backgroundImage3' : 'backgroundImage2']" :form="broadbandData" title="宽带发展" style="height: 228px"></charts>
            </el-col>

          </el-row>

          <div class="centerBottom">
            <div class="centerTop-title">
              <div class="titleLeft">{{ mapData.label }}发展量</div>
              <div class="titleRight">
                <span class="margin" v-if="this.mapData.level < 4" @click="showDialog(2)">
                  详细数据 <img width="9px" height="13px" src="~@/assets/images/bigScreen/resource/dleft.png" />
                </span>
                <div class="rightDialogBg" v-if="selectDialogShow">
                  <span v-for="item in selectDialogList">{{ item.name }}</span>
                </div>
              </div>
            </div>
            <div class="map">
              <iframe ref="iframe" :src="iframeSrc" frameborder="0" style="width: 100%; height: 100%"></iframe>
            </div>
          </div>
        </div>
        <!-- 右边 -->
        <div class="right">
          <div style="margin-top: 10px" @click="clickMode('7')" :class="[selectMode === '7' ? 'backgroundImage4' : 'backgroundImage']" class="backgroundImage">
            <div style="margin-left: 20px">
              <div style="display: block; height: 10px"></div>
              <span class="chartTitle">移网发展质态</span>
              <span class="chartSmTitle">
                新发展平均在网时长
                <span class="chartSmTitle_num">24</span>
                <span style="color: #ffcc00">个月</span>
              </span>
              <div class="borderLine"></div>
            </div>
            <!-- <div style="display: block; height: 10px"></div> -->
            <div style="margin-left: 20px; width: 100%">
              <span class="chartTitle">流失</span>
              <span style="float: right; margin-right: 50px; margin-top: 5px" @click="ywztDialogShow = true">更多
                <img width="9px" height="13px" style="margin-left: 10px" src="~@/assets/images/bigScreen/resource/dleft.png" />
              </span>
            </div>
            <div class="dialogTableBg1">
              <el-table ref="singleTable" :data="tableData_xrls" highlight-current-row style="width: 90%; margin-left: 5%">
                <el-table-column property="title" width="100" align="center"></el-table-column>
                <el-table-column property="dayLoss" label="当日流失" align="center"> </el-table-column>
                <el-table-column property="monLoss" label="月累流失" align="center"> </el-table-column>
                <el-table-column property="yearLoss" label="年累流失" align="center"> </el-table-column>
              </el-table>
            </div>
            <div style="display: block; height: 10px"></div>
            <div class="borderLine"></div>
            <div style="margin-left: 20px; width: 100%">
              <span class="chartTitle">携入</span>
            </div>
            <div class="dialogTableBg1">
              <el-table ref="singleTable" :data="tableData_xrls" highlight-current-row style="width: 90%; margin-left: 5%">
                <el-table-column property="dayMovein" label="当日携入" align="center"></el-table-column>
                <el-table-column property="monMovein" label="月累携入" align="center"> </el-table-column>
                <el-table-column property="yearMovein" label="年累携入" align="center"></el-table-column>
              </el-table>
            </div>
            <!-- <table></table> -->
            <div style="display: block; height: 10px"></div>
            <div class="borderLine"></div>
            <div style="margin-left: 20px; position: relative">
              <span class="chartTitle">移网三无低级</span>
              <div class="title-right">
                <div @click="tabClick(4, 'm')" :class="{ active: tabs[4] === 'm' }">月累</div>
                <div @click="tabClick(4, 'y')" :class="{ active: tabs[4] === 'y' }">年累</div>
              </div>
            </div>
            <div class="left-waterPoloChart">

              <!-- <div class="left-item" v-for="(i, index) in rightBottomPieList" :key="index">
                <div class="rightBottomPieChart" :id="`rightBottomPieChart${index}`"></div>
                <div class="itemName">{{ i.name }}</div>
                <div class="itemNum">{{ param.mLevel == 1 ? (i.num / 10000).toFixed(2) : i.num }}<span>万户</span></div>
                <div class="itemNum" v-if="param.mLevel == 1"><span>万户</span></div>
              </div> -->
              <div class="left-item" v-for="(i,index) in rightBottomPieList" :key="index">
                <div class="rightBottomPieChart" :id="`rightBottomPieChart${index}`"></div>
                <div class="itemName">{{i.name}}</div>
                <div class="itemNum">{{i.num}}<span>户</span></div>
                <div class="itemNum"></div>
              </div>
              <!-- <div class="left-item">
                <div class="rightBottomPieChart" id="rightBottomPieChart1"></div>
                <div class="itemName">三无用户</div>
                <div class="itemNum">{{}}<span>万户</span></div>
              </div>

              <div class="left-item">
                <div class="rightBottomPieChart" id="rightBottomPieChart2"></div>
                <div class="itemName">极低用户</div>
                <div class="itemNum">{{}}<span>万户</span></div>
              </div> -->

            </div>
          </div>

          <div style="margin-top: 10px" @click="clickMode('8')" :class="[selectMode === '8' ? 'backgroundImage4' : 'backgroundImage']" class="backgroundImage">
            <div style="margin-left: 20px; position: relative">
              <div style="display: block; height: 10px"></div>
              <span class="chartTitle">渠道门店规模</span>
              <div class="title-right">
                <div @click="tabClick(1, 'd')" :class="{ active: tabs[1] === 'd' }">当日</div>
                <div @click="tabClick(1, 'm')" :class="{ active: tabs[1] === 'm' }">月累</div>
                <div @click="tabClick(1, 'y')" :class="{ active: tabs[1] === 'y' }">年累</div>
              </div>
              <div class="borderLine"></div>
            </div>
            <span class="chartTitle" style="font-size: 20px; padding-left: 20px">
              门店总量:
              <span class="itemText1" style="margin-left: 20px">环比
                <span class="green">-2.12%</span>
              </span>
            </span>

            <div class="left-waterPoloChart">
              <div class="left-item" v-for="(i, index) in waterPoloList" :key="index">
                <div class="waterPoloChart" :id="`waterPoloChart${index}`"></div>
                <div class="itemName">
                  {{ i.name }}<span style="font-size: 14px; font-family: MFBanHei">{{ i.num }}</span>
                </div>
                <div class="itemText1">环比<span class="margin green">-2.12%</span></div>
              </div>
            </div>
            <div class="borderLine"></div>
            <span class="chartTitle" style="font-size: 20px; padding-left: 20px">
              乡镇门店:
              <span class="itemText1" style="margin-left: 20px">环比
                <span class="green">-2.12%</span>
              </span>
            </span>
            <div class="left-waterPoloChart" style="height: 150px; padding-bottom: 10px">
              <div class="left-item" v-for="(i, index) in waterPoloList2" :key="index">
                <div class="waterPoloChart" :id="`waterPoloChart2${index}`"></div>
                <div class="itemName">
                  {{ i.name }}<span style="font-size: 14px; font-family: MFBanHei">{{ i.num }}</span>
                </div>
                <div class="itemText1">环比<span class="margin green">-2.12%</span></div>
              </div>
            </div>
          </div>
        </div>
      </template>
    </FlexBox>
    <el-dialog :visible.sync="dialogVisible" width="88%">
      <template slot="title">
        <div style="margin-top: 10px; margin-left: 20px; width: 100%">
          <span class="chartTitle2">渠道门店-{{title}}产品详情</span>
          <img src="../../assets/images/bigScreen/fullService/Rectangle@2x.png" style="height: 14px; width: 86px; margin-left: 10px; margin-top: -3px" />
        </div>
      </template>
      <business-hall-detail v-if="dialogVisible" :selectmode="selectMode" :tabId='tabId' :params="param" :detailsn="detail_sn" :kpicode="detailCN_KPI_CODE"></business-hall-detail>
    </el-dialog>

    <el-dialog :visible.sync="dialogVisible2" width="88%">
      <template slot="title">
        <div style="margin-top: 10px; margin-left: 20px; width: 100%">
          <span class="chartTitle2">渠道门店-{{title}}产品详情</span>
          <img src="../../assets/images/bigScreen/fullService/Rectangle@2x.png" style="height: 14px; width: 86px; margin-left: 10px; margin-top: -3px" />
        </div>
      </template>
      <div class="tabbox">
        <qdmdywfzzttabdetal v-if="dialogVisible2" :params="param"></qdmdywfzzttabdetal>
      </div>
    </el-dialog>

    <five-g-dialog :biztype="BIZ_TYPE" :tabId='tabId' :params="param" v-if="fiveGDialogShow" @closeFiveGDialog="coloseDialog"></five-g-dialog>
    <ywfzt-dialog :biztype="BIZ_TYPE" :tabId='tabId' :params="param" v-if="ywztDialogShow" @closeDialog="coloseDialog2"></ywfzt-dialog>
  </div>
</template>

<script>
import Header from '@/components/BigScreen/Header'
import FlexBox from '@/components/BigScreen/FlexBox'
import chartsRight from '@/views/channelShop/components/chartsRight'
import chartsLeft from '@/views/channelShop/components/chartsLeft'
import charts from './components/charts'
import table from './components/table'
import waterPoloChart from '@/config/bigscreen/fullService-waterPoloChart.js'
import waterPoloChart2 from '@/config/bigscreen/fullService-waterPoloChart.js'
import rightBottomPieChart from '@/config/bigscreen/fullService-rightBottomPieChart.js'
import { getChanelData, chnl_store_zl_loss_movein, chnl_store_zl_sw_low } from '@/api/chanel.js'
import qdmdywfzzttabdetal from './components/qdmdywfzzt_tabdetal'
import { allLabels01, allLabels02 } from '@/api/bigscreen.js'
import store from 'store'
import businessHallDetail from '@/views/channelShop/components/businessHallDetail'
import fiveGDialog from './components/fiveGDialog';
import ywfztDialog from './components/ywfztDialog';
export default {
  components: {
    charts,
    Header,
    FlexBox,
    chartsRight,
    chartsLeft,
    businessHallDetail,
    table,
    qdmdywfzzttabdetal,
    fiveGDialog,
    ywfztDialog
  },
  name: 'index',
  data() {
    return {
      tabId: '03',
      ywztDialogShow: false,
      swLowData: {},
      BIZ_TYPE: '2', //1 移网   2 5G    3宽带
      fiveGDialogShow: false,
      detail_sn: 'chnl_store_5g_dev_detail',
      detailCN_KPI_CODE: 'CHNL_IC5G0001',
      mapLevel: '1',
      dialogVisible: false,
      dialogVisible2: false,
      gisQueryParams: {},
      //右侧弹出的select数组
      selectDialogList: [
        { name: '5G发展详情', type: 1 },
        { name: '移网发展详情', type: 2 },
        { name: '宽带发展详情', type: 3 },
        { name: '5G终端销量详情', type: 4 },
        { name: '智家发展详情', type: 5 },
        { name: '营销活动详情', type: 6 },
        { name: '两融发展详情', type: 7 },
        { name: '进厅详情', type: 8 },
        // {name:'进到地市、区县、 营服时看详情数据',type:1},
      ],
      detalListLeft: [],
      waterPoloList: [],
      waterPoloList2: [],
      rightBottomPieList: [],
      allList: [],
      tabs: ['d', 'd', 'd', 'm', 'm', 'd'],
      selectDialogShow: false,
      //map地址
      iframeSrc: '',
      //选中的模块
      selectMode: '1',
      bottomList: [{
        name: '营业厅',
        url: '/channel/businessHall/index',

      },
      {
        name: '渠道门店',
        url: '/channelShop/index',
        active: true
      }, {
        name: '卖场',
        url: '/channel/sale/index',


      }, {
        name: '轻触点',
        url: '/channel/touchPoint/index',

      },
      {
        name: '小微商户',
        url: '/SmallBusinesses/index',

      },
      {
        name: '农村',
        url: '/rural/index',

      }],
      tableData_xrls: [],

      //5g
      fiveGData: {},
      // 移网
      mobileData: {},
      //  宽带
      broadbandData: {},
      //  5G终端
      fiveGterminalData: {},
      //  智能管家
      // AIData: {},
      // 融合
      togetherData: {},
      // 主副卡
      mainAndNotMainData: {},
      //  金融
      financeData: {},
      soreList: [10, 1, 99, 2, 82],
      timest: '',
      mapData: {},
      userInfo: {},
      params: {},
      detalListLeft2: [],
      trendData: [],
      title: '5G发展',
      selectChanlTypeForDetai: '1',
    }
  },
  async created() {

    //获取时间
    this.timest = window.sessionStorage.getItem('selectTime')
    var initArea_id = ''
    if (store.get('userInfo').gridId) {
      this.mapData.level = 4;
      initArea_id = store.get('userInfo').gridId
    } else if (store.get('userInfo').areaCode) {
      this.mapData.level = 3;
      initArea_id = store.get('userInfo').areaCode
    } else if (store.get('userInfo').eparchyCode && store.get('userInfo').eparchyCode != '0000') {
      this.mapData.level = 2;
      initArea_id = store.get('userInfo').eparchyCode
    } else {
      this.mapData.level = 1;
      initArea_id = '0000'
    };
    this.mapData.area_id = initArea_id;
    this.initGisMap(initArea_id)
    //初始查询参数
    this.initParam()
    //初始化地图

  },
  mounted() {
    window.addEventListener('message', this.mapInit, true)
  },
  methods: {
    //获取时间
    async getDate(date) {
      this.timest = date
      this.$nextTick(() => {
        this.serviceInitParams()
      })
      this.gisQueryParams.timest = date
      this.gisQueryParams.message = "changeTime";
      var gisQueryParams = JSON.parse(JSON.stringify(this.gisQueryParams))
      this.$refs['iframe'].contentWindow.postMessage(gisQueryParams, '*')
      this.$forceUpdate()
    },
    //初始化地图
    initGisMap(initArea_id) {

      let level = this.mapData.level
      let timest = this.timest
      let se_type = this.params.se_type
      let type = this.params.type
      // 初始化地图参数
      this.gisQueryParams = {
        level: level,
        se_type: se_type,
        sceneid: '3',
        gis_sceneid: '6',
        area_id: initArea_id,
        poi_city_id: '',
        login_no: store.get('staffId'),
        timest: timest
      };
      this.iframeSrc = `http://134.32.115.253:18080/sdresview/?type=${type}&se_type=${se_type}&level=${level}&sceneid=3&gis_sceneid=6&area_id=${initArea_id}&poi_city_id=370100&timest=${timest}`
    },
    // 初始化参数
    initParam() {
      this.tabs = ['d', 'd', 'd', 'm', 'm', 'd'];
      this.userInfo = store.get('userInfo')
      Object.assign(this.mapData, { label: store.get('userInfo').dataAreaName || '各地市' })
      if (store.get('userInfo').gridId) {
        this.mapData.level = 4;
      } else if (store.get('userInfo').areaCode) {
        this.mapData.level = 3;
      } else if (store.get('userInfo').eparchyCode && store.get('userInfo').eparchyCode != '0000') {
        this.mapData.level = 2;
      } else {
        this.mapData.level = 1;
      };
      // 默认参数
      this.param = {
        timest: this.timest,
        eparchyCode: this.userInfo.eparchyCode || '',
        areaCode: this.userInfo.areaCode || '',
        gridId: this.userInfo.gridId || '',
        mLevel: this.mapData.level,
        flag: '1',
        chnlKindId: '',
        chnlKindTypeCode: '03'
      }
      this.changgeParams('1')
    },
    // 查询所有服务
    async serviceInitParams() {
      var params = this.param;
      this.param.timest = this.timest;
      params.chnlKindTypeCode = '03';
      if (this.mapData.level == 1) {
        params.eparchyCode = store.get('userInfo').eparchyCode || '0000';
        params.areaCode = ''
        params.gridId = ''
      } else if (this.mapData.level == 2) {
        params.eparchyCode = this.mapData.area_id
        params.areaCode = ''
        params.gridId = ''
      } else if (this.mapData.level == 3) {
        params.areaCode = this.mapData.area_id
        params.gridId = ''
      } else if (this.mapData.level == 4) {
        params.gridId = this.mapData.area_id
      }
      this.allLabelsData() // 查询所指标
      this.chnl_store_zl_loss_movein()
      this.chnl_store_zl_sw_low()
      this.fiveGData = await this.getchanelDataMethods('1') // 5G发展
      this.mobileData = await this.getchanelDataMethods('2') // 移网发展
      this.broadbandData = await this.getchanelDataMethods('3') // 宽带发展
      // this.fiveGterminalData = await this.getchanelDataMethods('4') //  5G终端

      this.togetherData = await this.getchanelDataMethods('5') // 移宽融合
      this.mainAndNotMainData = await this.getchanelDataMethods('6') // 移移融合
      this.financeData = await this.getchanelDataMethods('7') // 金融融合

    },

    //初始化地图参数
    mapInit(e) {
      let that = this
      if (e.data.message == 'levelSwitch') {
        that.mapData = e.data;
        that.gisQueryParams = Object.assign({}, that.gisQueryParams, e.data)
        that.param.timest = that.timest

        that.serviceInitParams()
      }
    },

    showDialog(item) {
      if (this.selectMode == '7' || this.selectMode == '8') {
        this.dialogVisible2 = true;
      } else {
        this.dialogVisible = true;
      }

    },

    // 选中模块
    changgeParams(type) {
      this.selectMode = type
      this.params.type = "05";
      if (type === '1') {
        this.params.se_type = "XUK0003";
        this.selectChanlTypeForDetai = '1'
        this.title = '5G发展';
        this.detail_sn = 'chnl_store_5g_dev_detail'
        this.detailCN_KPI_CODE = 'CHNL_IC5G0001'
      } else if (type === '2') {
        this.params.se_type = "XUK0001";
        this.title = '融合发展'
        this.selectChanlTypeForDetai = '6'
        this.detail_sn = 'chnl_store_yk_dev_detail' //移宽融合
        this.detailCN_KPI_CODE = 'CHNL_ICMOBILE0048' //移宽融

      } else if (type === '3') {
        this.params.se_type = "XUK0002";
        this.title = '5G发展'
      } else if (type === '4') {
        this.params.se_type = "XUK0007";
        this.title = '5G发展'
      } else if (type === '5') {
        this.params.se_type = "XUK0004";
        this.title = '移网发展'
        this.detail_sn = 'chnl_store_yw_dev_detail'
        this.selectChanlTypeForDetai = '2'
        this.detailCN_KPI_CODE = 'CHNL_ICMOBILE0001' //移宽融
      } else if (type === '6') {
        this.params.se_type = "XUK0005";
        this.title = '宽带发展'
        this.selectChanlTypeForDetai = '3'
        this.detail_sn = 'chnl_store_kd_dev_detail'
        this.detailCN_KPI_CODE = 'CHNL_ICBAND0001'
      } else if (type === '7') {
        this.params.se_type = "XUK0006";
        this.title = '移网发展质态'
        this.selectChanlTypeForDetai = '4'
        this.detail_sn = 'chnl_store_zt_dev_detail'
        this.detailCN_KPI_CODE = ''
      } else if (type === '8') {
        this.params.se_type = "XUK0008";
        this.title = '渠道门店规模'
        this.selectChanlTypeForDetai = '5'
        this.detail_sn = ''
        this.detailCN_KPI_CODE = ''
      }
      this.params.message = "changeType";

    },
    //点击相关模块
    clickMode(type) {
      this.changgeParams(type)
      let map = {
        timest: this.timest,
        se_type: this.params.se_type,
        type: this.params.type,
        level: this.mapData.level,
        area_id: this.mapData.area_id,
        sceneid: '3',
        gis_sceneid: '6',
        poi_city_id: '370100',
        changeType: '',
      };
      map.message = 'changeType'
      window.frames[0].postMessage(map, '*')
      this.$forceUpdate()
    },
    // 总览-移网质态发展-流失+携入
    chnl_store_zl_loss_movein() {
      var params = this.param
      params.CHNL_KIND_TYPE_CODE = '03';
      chnl_store_zl_loss_movein(params).then(data => {
        if (data.result) {
          if (data.result.data.length) {
            data.result.data[0].title = '新发展';
          }

          this.tableData_xrls = data.result.data
          console.log('ri', this.tableData_xrls)
        }
      })
    },
    chnl_store_zl_sw_low() {
      var params = this.param
      params.CHNL_KIND_TYPE_CODE = '03';
      chnl_store_zl_sw_low(params).then(data => {
        if (data.result) {
          let item = ''
          this.ywsw == 'curMon' ? item = 'mon' : item = 'year'
          let rb = data.result ? data.result.data[0] : ''
          this.rightBottomPieList = [{
            name: '三无用户',
            num: rb[`${item}Sw`] ? rb[`${item}Sw`] : '-',
            value: rb[`${item}SwRate`] ? rb[`${item}SwRate`] : '-',
          }, {
            name: '极低用户',
            num: rb[`${item}Low`] ? rb[`${item}Low`] : '-',
            value: rb[`${item}LowRate`] ? rb[`${item}LowRate`] : '-',
          }]
          setTimeout(() => {
            this.rightBottomPieList.map((i, index) => {
              this.rightBottomPieChart(index, i);
            });
          }, 0);
          //   this.swLowData = data.result.data[0] || {}
          //   let data1 = {
          //     id: 'rightBottomPieChart1',
          //     value: this.swLowData.monSwRate,
          //   }
          //   rightBottomPieChart.initChart(data1)
          //   let data2 = {
          //     id: 'rightBottomPieChart2',
          //     value: this.swLowData.monLowRate,
          //   }
          //   rightBottomPieChart.initChart(data2)
        }
      })
    },
    //获取数据
    async getchanelDataMethods(type) {
      this.param.flag = type
      try {
        let res = await getChanelData(this.param)
        return res?.result?.tblList[0]
      } catch (e) {
        // this.requestFailed(err);
        return {}
      }
    },
    allLabelsData() {
      let that = this
      let param = {
        timest: that.param.timest,
        eparchyCode: that.param.eparchyCode,
        areaCode: that.param.areaCode,
        gridId: that.param.gridId,
        mLevel: that.param.mLevel,
      }
      let p1 = new Promise((resolve) => {
        allLabels01(param).then((res) => {
          resolve(res.result.data)
        })
      })
      let p2 = new Promise((resolve) => {
        allLabels02(param).then((res) => {
          resolve(res.result.data)
        })
      })

      Promise.all([p1, p2])
        .then((data) => {
          that.allList = Object.assign(data[0], data[1])
          that.waterPoloChartList(this.tabs[1])
          that.waterPoloChartList2(this.tabs[1])
          that.rightBottomPieChartList(this.tabs[4])
        })
        .catch((error) => {
          console.log(error)
        })
    },
    tabClick(index, val) {
      this.$set(this.tabs, index, val)
      if (index == 0) {
        this.leftTopChart(val)
      } else if (index == 1) {
        this.waterPoloChartList(val)
        this.waterPoloChartList2(val)
      } else if (index == 4) {
        this.rightBottomPieChartList(val)
      }
    },
    waterPoloChartList2(val) {
      let result = this.allList || ''
      const ICMOBILE0012 = result.ICMOBILE0012 || ''
      const ICMOBILE0013 = result.ICMOBILE0013 || ''
      this.waterPoloList2 = [
        {
          name: '乡镇有效门店',
          num: ICMOBILE0012
            ? (val == 'd' && (ICMOBILE0012.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0012.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0012.curYear || '-'))
            : '-',
          value: ICMOBILE0013
            ? (val == 'd' && (ICMOBILE0013.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0013.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0013.curYear || '-'))
            : '-',
        },
      ]

      setTimeout(() => {
        this.waterPoloList2.map((i, index) => {
          this.waterPoloChart2(index, i)
        })
      }, 0)
    },
    waterPoloChartList(val) {
      let result = this.allList || ''
      const ICMOBILE0012 = result.ICMOBILE0012 || ''
      const ICMOBILE0013 = result.ICMOBILE0013 || ''
      const ICMOBILE0014 = result.ICMOBILE0014 || ''
      const ICMOBILE0015 = result.ICMOBILE0015 || ''
      const ICMOBILE0016 = result.ICMOBILE0016 || ''
      const ICMOBILE0017 = result.ICMOBILE0017 || ''
      this.waterPoloList = [
        {
          name: '核心门店',
          num: ICMOBILE0012
            ? (val == 'd' && (ICMOBILE0012.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0012.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0012.curYear || '-'))
            : '-',
          value: ICMOBILE0013
            ? (val == 'd' && (ICMOBILE0013.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0013.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0013.curYear || '-'))
            : '-',
        },
        {
          name: '有效门店',
          num: ICMOBILE0014
            ? (val == 'd' && (ICMOBILE0014.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0014.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0014.curYear || '-'))
            : '-',
          value: ICMOBILE0015
            ? (val == 'd' && (ICMOBILE0015.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0015.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0015.curYear || '-'))
            : '-',
        },
        {
          name: '活跃门店',
          num: ICMOBILE0016
            ? (val == 'd' && (ICMOBILE0016.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0016.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0016.curYear || '-'))
            : '-',
          value: ICMOBILE0017
            ? (val == 'd' && (ICMOBILE0017.curDay || '-')) ||
            (val == 'm' && (ICMOBILE0017.curMon || '-')) ||
            (val == 'y' && (ICMOBILE0017.curYear || '-'))
            : '-',
        },
      ]

      setTimeout(() => {
        this.waterPoloList.map((i, index) => {
          this.waterPoloChart(index, i)
        })
      }, 0)
    },
    openfiveGDialogShow() {

      this.fiveGDialogShow = true;
    },
    coloseDialog() {
      this.fiveGDialogShow = false
    },
    coloseDialog2() {
      this.ywztDialogShow = false
    },
    waterPoloChart(index, val) {
      let data = {
        id: 'waterPoloChart' + index,
        value: val.value,
      }
      waterPoloChart.initChart(data)
    },
    waterPoloChart2(index, val) {
      let data = {
        id: 'waterPoloChart2' + index,
        value: val.value,
      }
      waterPoloChart2.initChart(data)
    },
    rightBottomPieChartList(val) {
      let result = this.allList || ''
      const ICMOBILE0037 = result.ICMOBILE0037 || ''
      const ICMOBILE0038 = result.ICMOBILE0038 || ''
      const ICMOBILE0039 = result.ICMOBILE0039 || ''
      const ICMOBILE0040 = result.ICMOBILE0040 || ''
      this.rightBottomPieList = [
        {
          name: '三无用户',
          num: ICMOBILE0037
            ? (val == 'm' && (ICMOBILE0037.curMon || '-')) || (val == 'y' && (ICMOBILE0037.curYear || '-'))
            : '-',
          value: ICMOBILE0038
            ? (val == 'm' && (ICMOBILE0038.curMon || '-')) || (val == 'y' && (ICMOBILE0038.curYear || '-'))
            : '-',
        },
        {
          name: '极低用户',
          num: ICMOBILE0039
            ? (val == 'm' && (ICMOBILE0039.curMon || '-')) || (val == 'y' && (ICMOBILE0039.curYear || '-'))
            : '-',
          value: ICMOBILE0040
            ? (val == 'm' && (ICMOBILE0040.curMon || '-')) || (val == 'y' && (ICMOBILE0040.curYear || '-'))
            : '-',
        },
      ]

      setTimeout(() => {
        this.rightBottomPieList.map((i, index) => {
          this.rightBottomPieChart(index, i)
        })
      }, 0)
    },
    rightBottomPieChart(index, val) {
      let data = {
        id: 'rightBottomPieChart' + index,
        value: val.value,
      }
      rightBottomPieChart.initChart(data)
    },
  },
  destroyed() {
    // 在组件生命周期结束的时候销毁。
    window.removeEventListener('message', this.mapInit, true)
  },
}
</script>

<style lang="scss" scoped>
/deep/ .bottom {
  width: 40% !important;
  left: 30% !important;
}
.container {
  position: relative;
  display: flex;
  flex-direction: column;
  overflow: auto;
  width: 100%;
  height: 100%;
  color: #fff;
  background: #01153b;
  // background-image: image-set(
  //     url("~@/assets/images/bigScreen/bg.jpg") 1x,
  //     url("~@/assets/images/bigScreen/bg@2x.jpg") 2x
  // );
  // background-repeat: no-repeat;
  // background-size: 100% 100%;
  overflow: hidden;
  .header-smallTitle {
    font-size: 36px;
    font-family: MFBanHei;
    font-weight: 400;
    color: #ffffff;
    margin-top: -7px;
  }
}
.content {
  .left {
    width: 23%;
  }
  .center {
    flex: 1;
    margin: 0 20px;
    .centerTop {
      width: 100%;
      height: 245px;
      background-image: image-set(
        url('~@/assets/images/bigScreen/fullService/center-top.png') 1x,
        url('~@/assets/images/bigScreen/fullService/center-top@2x.png') 2x
      );
      background-repeat: no-repeat;
      background-size: 100% 100%;
    }
  }
  .right {
    width: 23%;
    .rightBottomPieChart {
      width: 120px;
      height: 90px;
      margin: 0 auto;
    }
  }
  /deep/ .el-table--enable-row-hover .el-table__body tr:hover > td {
    background: #20458a;
    color: #fff;
  }
  /deep/ .el-table {
    background: none !important;
  }
  .backgroundImage {
    background-image: url('../../assets/images/bigScreen/fullService/chanel_bus_left_title_bg@2x.png');
    background-size: 100% 100%;
  }
  .backgroundImage2 {
    background-image: url('../../assets/images/bigScreen/fullService/chanel_business_bg@2x.png');
    background-size: 100% 100%;
  }
  .backgroundImage3 {
    background-image: url('../../assets/images/bigScreen/fullService/chanle_select_bg.png');
    // background-image: url('../../assets/images/bigScreen/fullService/chanle_select_bg.png');
    background-size: 100% 100%;
  }
  .backgroundImage4 {
    background-image: url('../../assets/images/bigScreen/fullService/chnlBgSelec.png');
    background-size: 100% 100%;
  }

  .borderLine {
    width: 80%;
    margin-left: 10%;
    margin-top: 10px;
    height: 1px;
    border-bottom: 1px dashed #009bff !important;
    border-image: -webkit-linear-gradient(#009bff, #16e4cf) 30 30;
    border-image: -moz-linear-gradient(#009bff, #16e4cf) 30 30;
    border-image: linear-gradient(#009bff, #16e4cf) 30 30;
  }
  .chartTitle {
    // margin-top: 10px;
    // margin: auto 0;
    margin-left: 10px;
    font-family: 'MFBanHei';
    color: #02f6ff;
    font-size: 24px;
  }
  .chartSmTitle {
    font-family: 'MicrosoftYaHei';
    color: #02f6ff;
    font-size: 12px;
    line-height: 18px;
    margin-left: 20px;
  }
  .chartSmTitle_num {
    color: #ffcc00;
    font-size: 16px;
    font-family: 'DigifaceWide';
  }
  /deep/.el-table th {
    background-color: #023e5d !important;
    // background: url('../../assets/images/bigScreen/fullService/597bcdc505fa3.png') no-repeat !important;
    background-position: bottom, center;
    color: #fff !important;
    padding-left: 5px !important;
    padding-top: 5px !important;
    padding-bottom: 5px !important;
    font-size: 14px !important;
  }
  /deep/ .el-table tr {
    background-color: #01274a !important;
    color: #fff;
    font-size: 14px !important;
  }
  /deep/.el-table td {
    // border: none !important;
    color: #ffffff;
    // border-right: 0.5px solid #0a3d75 !important;
    padding-left: 5px !important;
    padding-top: 4px !important;
    padding-bottom: 4px !important;
    border-bottom: 0px !important;
  }
  /deep/.el-table th.is-leaf,
  .el-table td {
    border-bottom: 0px solid #dfe6ec !important;
  }
}
.map_bg {
  background-image: url('../../assets/images/bigScreen/fullService/map_bg.png');
  background-size: 100% 100%;
  padding: 10px 30px 30px;
  height: 69%;
  margin-top: 10px;
  //height: 917.5px;
}
.map {
  padding: 10px 30px 30px;
  height: 90%;
}
.centerTop-title {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 30px 0 40px;
  .titleLeft {
    padding-right: 110px;
    font-size: 24px;
    font-family: MFBanHei;
    font-weight: 400;
    color: #02f6ff;
    background-image: image-set(
      url('~@/assets/images/bigScreen/fullService/Rectangle 561.png') 1x,
      url('~@/assets/images/bigScreen/fullService/Rectangle@2x.png') 2x
    );
    background-repeat: no-repeat;
    background-position: center right;
  }
  .titleRight {
    font-size: 14px;
    font-family: Microsoft YaHei;
    font-weight: 400;
    color: #a5e8fe;
    cursor: pointer;
  }
}
.centerBottom {
  width: 100%;
  height: 631px;
  margin-top: 20px;
  background-image: image-set(
    url('~@/assets/images/bigScreen/fullService/mapBg.png') 1x,
    url('~@/assets/images/bigScreen/fullService/mapBg@2x.png') 2x
  );
  background-repeat: no-repeat;
  background-size: 100% 100%;
  .centerTop-title {
    padding-top: 30px;
  }
  .margin {
    margin-right: 20px;
  }
  .map {
    padding: 10px 30px 30px;
    height: 90%;
  }
}
.rightDialogBg {
}
.itemText1 {
  font-size: 9px;
  color: #02f6ff;
  transform: scale(0.8);
  .green {
    color: #66ff00 !important;
  }
}
/deep/ .el-dialog {
  -webkit-transform: none;
  transform: none;
  left: 0;
  position: relative;
  margin: 0 auto;
  background-image: url('~@/assets/images/bigScreen/kuang.png');
  background-size: 100% 100%;
  height: 760px;
  background-color: rgba(220, 38, 38, 0);
}
.chartTitle2 {
  margin-top: 10px;
  margin-left: 10px;
  font-family: 'MFBanHei';
  color: #02f6ff;
  font-size: 24px;
}
.left-waterPoloChart {
  width: 100%;
  text-align: center;
  display: flex;
  justify-content: center;
  align-items: center;
  .left-item {
    flex: 3;
    color: #02f6ff;
    margin-top: 10px;
  }
  .waterPoloChart {
    width: 84px;
    height: 84px;
    margin: 0 auto;
    margin-bottom: 10px;
  }
  .itemName {
    font-size: 12px;
  }
  .itemNum {
    font-family: 'DigifaceWide';
    font-size: 18px;
    span {
      font-size: 12px;
    }
  }
}
.title-right {
  color: #218cc8;
  font-size: 12px;
  font-family: Microsoft YaHei;
  position: absolute;
  right: 40px;
  top: 12px;
  div {
    width: 38px;
    height: 30px;
    line-height: 30px;
    text-align: center;
    display: inline-block;
    cursor: pointer;
    background-image: image-set(
      url('~@/assets/images/bigScreen/fullService/left-sub.png') 1x,
      url('~@/assets/images/bigScreen/fullService/left-sub@2x.png') 2x
    );
    background-repeat: no-repeat;
    background-size: 100% 100%;
  }
  .active {
    color: #02f6ff;
    background-image: image-set(
      url('~@/assets/images/bigScreen/fullService/left-subActive.png') 1x,
      url('~@/assets/images/bigScreen/fullService/left-subActive@2x.png') 2x
    );
  }
}
/deep/ .el-dialog__headerbtn .el-dialog__close {
  color: #fff;
  font-size: 24px;
  font-weight: 500;
  margin: 10px 30px 0 0;
  border: 2px solid #193987;
  border-radius: 5px;
  background: #1e1e88;
}
/deep/ .el-dialog__body {
  padding: 0px 20px;
}
/deep/ .v-modal {
  z-index: -2 !important;
}
</style>
